
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="计算机图形学概论(graphicsbook)">
      
      
      
        <link rel="canonical" href="https://hellowac.github.io/graphicsbook-zh-cn/cn/c5/s1/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../s2/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>5.1 Three.js 基础 - 计算机图形学概论</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M6 13h8l-3.5 3.5 1.42 1.42L17.84 12l-5.92-5.92L10.5 7.5 14 11H6v2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="default" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#51-threejs-基础" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="计算机图形学概论" class="md-header__button md-logo" aria-label="计算机图形学概论" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            计算机图形学概论
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5.1 Three.js 基础
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/graphicsbook-zh-cn/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/graphicsbook-zh-cn/cn/" hreflang="cn" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/graphicsbook-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    graphicsbook
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../preface/" class="md-tabs__link">
        
  
    
  
  前言

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c1/" class="md-tabs__link">
          
  
    
  
  1.简介

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c2/" class="md-tabs__link">
          
  
    
  
  2.二维图形

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c3/" class="md-tabs__link">
          
  
    
  
  3.几何

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c4/" class="md-tabs__link">
          
  
    
  
  4.灯光和材质

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  5.three.js

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c6/" class="md-tabs__link">
          
  
    
  
  6.WebGL

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c7/" class="md-tabs__link">
          
  
    
  
  7.WebGL 3D

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c8/" class="md-tabs__link">
          
  
    
  
  8.高阶3D

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c9/" class="md-tabs__link">
          
  
    
  
  9.WEBGPU

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../a1/" class="md-tabs__link">
          
  
    
  
  附录

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  关于

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="计算机图形学概论" class="md-nav__button md-logo" aria-label="计算机图形学概论" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    计算机图形学概论
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/graphicsbook-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    graphicsbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前言
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c1/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    1.简介
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            1.简介
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 1 节 绘画与绘图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 2 节：三维(3D)图形的要素
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第 3 节：硬件与软件
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    2.二维图形
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2.二维图形
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第1节: 像素、坐标和颜色
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第2节: 形状
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第3节: 变换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第4节: 分层建模
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第5节: Java 绘制2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第6节: HTML Canvas图形
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第7节: SVG：一种场景描述语言
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c3/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    3.几何
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            3.几何
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 OpenGL 1.1 中的形状和颜色
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 3D 坐标和变换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 投影与观看
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 多边形网格和 glDrawArrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5 部分线性代数基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.6 使用 GLUT 和 JOGL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c4/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    4.灯光和材质
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            4.灯光和材质
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 照明简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 OpenGL 1.1 中的光和材质
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 图像纹理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 灯光、相机、动作
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    5.three.js
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            5.three.js
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    5.1 Three.js 基础
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    5.1 Three.js 基础
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#511-关于-javascript-模块" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.1 关于 JavaScript 模块
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#512-场景渲染器相机" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.2 场景、渲染器、相机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#513-threeobject3d" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.3 THREE.Object3D
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#514-物体几何形状材料" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.4 物体、几何形状、材料
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#515-灯光" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.5 灯光
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#516-建模示例" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.6 建模示例
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 构建对象
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 其他功能
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c6/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    6.WebGL
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            6.WebGL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 可编程流水线
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 第一个例子
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3 GLSL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4 图像纹理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5 实现 2D 变换
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c7/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    7.WebGL 3D
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            7.WebGL 3D
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 3D变换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2 照明和材质
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3 纹理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4 帧缓冲区
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.5 WebGL 扩展
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c8/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    8.高阶3D
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            8.高阶3D
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.1 光线追踪
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.2 路径追踪
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c9/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    9.WEBGPU
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            9.WEBGPU
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.1 WebGPU 基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.2 实例和索引
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.3 WGSL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.4 WebGPU 中的 3D 图形
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.5 纹理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.6 计算着色器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../c9/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.7 细节
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../a1/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    附录
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_12" id="__nav_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            附录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a2/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blender 3D建模
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a3/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gimp和Inkscape
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    示例程序源代码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    术语表
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#511-关于-javascript-模块" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.1 关于 JavaScript 模块
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#512-场景渲染器相机" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.2 场景、渲染器、相机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#513-threeobject3d" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.3 THREE.Object3D
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#514-物体几何形状材料" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.4 物体、几何形状、材料
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#515-灯光" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.5 灯光
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#516-建模示例" class="md-nav__link">
    <span class="md-ellipsis">
      5.1.6 建模示例
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="51-threejs-基础">5.1 Three.js 基础<a class="headerlink" href="#51-threejs-基础" title="Permanent link">&para;</a></h1>
<p><strong>Three.js Basics</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Three.js 是一个用于 3D 图形的面向对象 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 库。它是由 Ricardo Cabello（化名 "mr.doob"，<a href="https://mrdoob.com/">https://mrdoob.com/</a>）最初创建的开源项目，并且得到了其他程序员的贡献。它似乎是最受欢迎的开源 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 库，用于 3D Web 应用程序。（另一个受欢迎的选择是 <a href="https://www.babylonjs.com/">Babylon.js</a>。）Three.js 使用了你已经熟悉的概念，比如几何对象、变换、灯光、<abbr title="决定物体如何在环境中与光互动的属性。OpenGL中的材质属性包括，例如，散射颜色、镜面颜色和光泽度。">材质</abbr>、纹理和摄像机。但它也有额外的特性，这些特性建立在 <abbr title="A 3D graphics API for use on web pages. WebGL programs are written in the JavaScript programming language and display their images in HTML canvas elements. WebGL is based on OpenGL ES, the version of OpenGL for embedded systems, with a few changes to adapt it to the JavaScript language and the Web environment.">WebGL</abbr> 的强大和灵活性之上。</p>
<p>你可以在它的主网站 <a href="https://threejs.org">https://threejs.org</a> 下载 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 并阅读文档。下载的文件相当大，因为它包括了许多示例和支持文件。这本书使用的是 2023 年 7 月发布的版本 154。你应该意识到，你可能在网上找到的关于 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 的一些材料并不适用于最新版本。</p>
<p><em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 的当前版本是一个“模块化”的 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 库。旧的非模块化形式仍然可用，但它已被弃用，并计划在版本 160 中移除。这本教科书的以前版本使用了非模块化版本。教科书的第 1.4 版已经更新为使用 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 模块；除此之外，<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 材料只针对 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 版本之间的一些小差异进行了更改。（值得注意的是，我发现我必须显著增加材质颜色的镜面分量。）</p>
<p>本书中使用的所有 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 脚本副本可以在教科书网站源文件夹中的 <a href="../../../en/source/threejs/script">threejs/script</a> 文件夹中找到。<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 许可证允许这些文件自由重新分发。但如果你计划认真使用 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>，你应该阅读其网站上的文档，了解如何使用它以及如何部署它。</p>
<p><em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 的核心特性定义在一个名为 "three.module.js" 的单一大型 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 文件中，该文件可以在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 下载中的构建目录中找到。还有一个更小的 "压缩" 版本，<em>three.module.min.js</em>，它包含了相同定义，但格式不适合人类阅读。通常在网页上使用的是压缩版本。除了这个核心之外，<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 下载还有一个目录，包含许多示例和在示例中使用的各种支持文件。示例使用了许多不是 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 核心部分的特性。这些插件可以在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 下载的 examples 文件夹内的 jsm 文件夹中找到。其中一些插件在这本教科书中使用，并包含在 <a href="../../../en/source/threejs/script">threejs/script</a> 文件夹中。</p>
</div>
<div class="tabbed-block">
<p>Three.js is an object-oriented <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> library for 3D graphics. It is an open-source project originally created by Ricardo Cabello (who goes by the handle "mr.doob", <a href="https://mrdoob.com/">https://mrdoob.com/</a>), with contributions from other programmers. It seems to be the most popular open-source <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> library for 3D web applications. (Another popular option is <a href="https://www.babylonjs.com/">Babylon.js</a>.) Three.js uses concepts that you are already familiar with, such as geometric objects, transformations, lights, materials, textures, and cameras. But it also has additional features that build on the power and flexibility of WegGL.</p>
<p>You can download <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> and read the documentation at its main web site, <a href="https://threejs.org">https://threejs.org</a>. The download is quite large, since it includes many examples and support files. This book uses Release 154 of the software, from July, 2023. You should be aware that some of the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> about <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> that you might find on the Internet does not apply to the most recent release.</p>
<p>The current release of <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> is a "modular" <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> library. The older, non-modular form is still available, but it is deprecated and is scheduled to be removed in Release 160. Previous versions of this textbook used the non-modular version. Version 1.4 of the textbook has been updated to use <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> modules; aside from that, the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> has been changed only to account for some minor differences between <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> releases. (Notably, I found that I had to significantly increase the specular component of <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> colors.)</p>
<p>Copies of all <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> scripts that are used in this textbook can be found in the <a href="../../../en/source/threejs/script">threejs/script</a> folder in the source folder of this textbook's web site. The <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> license allows these files to be freely redistributed. But if you plan to do any serious work with <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>, you should read the documentation on its web site about how to use it and how to deploy it.</p>
<p>The core features of <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> are defined in a single large <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> file named "three.module.js", which can be found in a build directory in the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> download. There is also a smaller "minified" version, <em>three.module.min.js</em>, that contains the same definitions in a format that is not meant to be human-readable. It is the minified version that is usually used on web pages. In addition to this core, the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> download has a directory containing many examples and a variety of support files that are used in the examples. The examples use many features that are not part of the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> core. These add-ons can be found in a folder named jsm inside the folder named examples in the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> download. Several of the add-ons are used in this textbook and are included in the <a href="../../../en/source/threejs/script">threejs/script</a> folder.</p>
</div>
</div>
</div>
<h2 id="511-关于-javascript-模块">5.1.1 关于 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 模块<a class="headerlink" href="#511-关于-javascript-模块" title="Permanent link">&para;</a></h2>
<p><strong>About <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> Modules</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>"模块"一词通常指的是系统中相对独立的组件。模块以有限且明确定义的方式进行交互。它们是构建复杂系统的重要工具。在 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 中，模块是一个与其他脚本隔离的脚本，除非模块可以“导出”它定义的标识符。一个脚本导出的标识符可以被另一个脚本“导入”。如果一个模块的标识符没有被一个模块显式导出并被另一个模块导入，那么模块只能访问来自另一个模块的标识符。模块还可以访问非模块化脚本的标识符，而无需导入它们。</p>
<p><abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 模块可以通过在其声明上添加 export 修饰符来导出标识符。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">RED</span><span class="o">=</span><span class="s2">&quot;0xFF0000&quot;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">setColor</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
<span class="k">export</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>或者，它可以在其 export 语句中列出它想要导出的标识符。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">RED</span><span class="p">,</span><span class="w"> </span><span class="nx">setColor</span><span class="p">,</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<p>export 语句有许多其他选项。然而，在这里我们主要感兴趣的是从 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 模块导入。</p>
<p>要使用模块化的 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr>，您将需要编写一个模块化脚本。你可以通过在 <code>&lt;script&gt;</code> 元素上添加 type="module" 属性来在网页上实现：</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>
<p>然后，脚本可以使用 import 语句来访问其他模块中的标识符。例如，</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="p">,</span><span class="w"> </span><span class="nx">setColor</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./drawutil.js&quot;</span><span class="p">;</span>
.
. // 像平常一样使用 FancyDraw 和 setColor！
.
</code></pre></div>
<p>这假设导出标识符的模块定义在与网页相同目录下名为 drawutil.js 的脚本中。注意，如果脚本路径从当前目录开始，那么脚本名称必须以 "./" 开头。</p>
<p>我的 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 示例使用与网页同一目录下名为 script 的目录中的 three.module.min.js 文件。它们可以使用以下方式从该文件导入所有内容：</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">THREE</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./script/three.module.min.js&quot;</span><span class="p">;</span>
</code></pre></div>
<p>这种形式的 import 语句从 three.module.min.js 获取所有导出，并使它们成为名为 THREE 的新对象的属性。例如，导出的标识符 Mesh 被导入为 THREE.Mesh。再次强调，import 语句有其他形式，这里没有覆盖。</p>
<hr />
<p>我的许多示例使用不在主要 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 脚本中的插件。我已经将使用它们的文件放置在我的 <a href="https://math.hws.edu/graphicsbook/source/threejs/script">脚本目录</a> 的子目录中。所有文件都来自 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 下载中的 examples/jsm 文件夹。我使用了与该文件夹相同的子目录结构，因为一些文件通过名称引用其他子目录中的文件。其中一个插件脚本是 "controls" 子目录中的 "OrbitControls.js"。它导出了一个名为 OrbitControls 的类，可以使用以下方式导入：</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">OrbitControls</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./script/controls/OrbitControls.js&quot;</span><span class="p">;</span>
</code></pre></div>
<p>插件模块从主要的 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 模块导入许多资源。不幸的是，它们不知道在哪里找到该文件。它们依赖于所谓的“import map”来指定其位置。可以通过另一种类型脚本，type="importmap" 来定义 import map。因此，你会看到我的许多示例脚本以这种方式开始：</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;importmap&quot;</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;imports&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;three&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./script/three.module.min.js&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;addons/&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./script/&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">THREE</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;three&quot;</span><span class="p">;</span>
import { OrbitControls } from &quot;addons/controls/OrbitControls.js&quot;;
import { GLTFLoader } from &quot;addons/loaders/GLTFLoader.js&quot;;
</code></pre></div>
<p>"importmap" 脚本的内容是一个 <abbr title="(JavaScript Object Notation.) A syntax for representing JavaScript objects as strings, similar to the object literal syntax that is used in JavaScript. JSON objects cannot contain functions, but they can contain strings, numbers, and booleans. JSON has become a popular standard for storage and transmission of structured data.">JSON</abbr> 对象。这里的 import map 定义 "three" 指向主要的 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 文件，并定义 "addons/" 指向脚本目录。插件模块将主要的 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 模块引用为 "three"，因此该映射是必要的。"addons/" 映射实际上对我的示例是不需要的。</p>
<hr />
<p>我只给你提供了一个非常简短的 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 模块概述——足够了，我希望让你理解我的示例程序，并编写一些类似的程序。对于更复杂的项目，你应该看看 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 开发者关于设置开发环境的说法。请参阅手册的 "Installation" 部分 <a href="https://threejs.org/docs/">https://threejs.org/docs/</a>。</p>
</div>
<div class="tabbed-block">
<p>The term "module" refers in general to a relatively independent component of a system. Modules interact in limited, well-defined ways. They are an important tool for building complex systems. In <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr>, a module is a script that is isolated from other scripts, except that a module can "export" identifiers that it defines. Identifiers that are exported by one script can then be "imported" by another script. A module only has access to an identifier from another module if the identifier is explicitly exported by one module and imported by the other. Modules can also access identifiers from non-modular scripts, without having to import them.</p>
<p>A <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> module can export an identifier by adding the export modifier to its declaration. For example,</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">RED</span><span class="o">=</span><span class="s2">&quot;0xFF0000&quot;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">setColor</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span>
<span class="k">export</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span>
</code></pre></div>
<p>Alternatively, it can list the identifiers that it wants to export in an export statement. For example,</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">RED</span><span class="p">,</span><span class="w"> </span><span class="nx">setColor</span><span class="p">,</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<p>The export statement has many other options. However, here we are mostly interested in importing from <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> modules.</p>
<p>To use modular <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr>, you will need to write a modular script. You can do that on a web page by adding the <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr> type="module" to the <code>&lt;script&gt;</code> element:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w"> </span>
<span class="w">    </span><span class="p">.</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>
<p>The script can then use import statements to access identifiers from other modules. For example,</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FancyDraw</span><span class="p">,</span><span class="w"> </span><span class="nx">setColor</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./drawutil.js&quot;</span><span class="p">;</span>
.
. // Use FancyDraw and setColor as usual!
.
</code></pre></div>
<p>This assumes that the module that exports the identifiers is defined in a script named drawutil.js in the same directory as the web page. Note that if the path to the script starts in the current directory, then the script name must start with "./".</p>
<p>My <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> examples use the file three.module.min.js from a directory named script in the same directory as the web page. They can import everything from that file using:</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">THREE</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./script/three.module.min.js&quot;</span><span class="p">;</span>
</code></pre></div>
<p>This form of the import statement gets all the exports from three.module.min.js and makes them properties of a new object named THREE. For example, the exported identifier Mesh is imported as THREE.Mesh. Again, the import statement has other forms, which are not covered here.</p>
<hr />
<p>Many of my examples use add-ons that are not part of the main <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> script. I have placed the files that use them in subdirectories of my <a href="https://math.hws.edu/graphicsbook/source/threejs/script">script directory</a>. All of the files come from the examples/jsm folder in the <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> download. I have used the same subdirectory structure as that folder, because some of the files refer to files in other subdirectories by name. One of the add-on scripts is "OrbitControls.js" in the "controls" subdirectory. It exports a class named OrbitControls, which can be imported using</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Orbitcontrols</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./script/controls/OrbitControls.js&quot;</span><span class="p">;</span>
</code></pre></div>
<p>The add-on modules import many resources from the main <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> module. Unfortunately, they don't know where to find that file. They rely on something called an "import map" to specify its location. An import map can be defined by another kind of script, with type="importmap". So, you will see that the scripts in many of my examples start something like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;importmap&quot;</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;imports&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;three&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./script/three.module.min.js&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;addons/&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;./script/&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">THREE</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;three&quot;</span><span class="p">;</span>
import { OrbitControls } from &quot;addons/controls/OrbitControls.js&quot;;
import { GLTFLoader } from &quot;addons/loaders/GLTFLoader.js&quot;;
</code></pre></div>
<p>The content of an "importmap" script is a <abbr title="(JavaScript Object Notation.) A syntax for representing JavaScript objects as strings, similar to the object literal syntax that is used in JavaScript. JSON objects cannot contain functions, but they can contain strings, numbers, and booleans. JSON has become a popular standard for storage and transmission of structured data.">JSON</abbr> object. The import map here defines "three" to refer to the main <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> file, and it defines "addons/" to refer to the script directory. The add-on modules refer to the main <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> module as "three", so that mapping is necessary. The "addons/" mapping is actually not needed for my examples.</p>
<hr />
<p>I have given you only a very brief overview of <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> modules—enough, I hope to let you understand my sample programs and write some similar programs of your own. For more complex projects, you should look at what the <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> developers have to say about setting up a development environment. See the "Installation" section of the Manual at <a href="https://threejs.org/docs/">https://threejs.org/docs/</a>.</p>
</div>
</div>
</div>
<h2 id="512-场景渲染器相机">5.1.2 场景、渲染器、<abbr title="在三维计算机图形中，将投影和观察变换组合成一个抽象，模拟物理相机或眼睛。">相机</abbr><a class="headerlink" href="#512-场景渲染器相机" title="Permanent link">&para;</a></h2>
<p><strong>Scene, Renderer, Camera</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><em>Three.js</em> 与 <abbr title="HyperText Markup Language. A language that is used for specifying the content of web pages. An HTML document is made up of text, along with &quot;elements&quot; for adding other content, such as images, and for defining the structure of the document. Because of nesting of elements, the document can be represented by a tree-like data structure.">HTML</abbr> <code>&lt;canvas&gt;</code> 元素一起工作，这是我们在 <a href="../../c2/s6/">第2.6节</a> 中用于2D图形的相同元素。几乎所有的网络浏览器中，除了其2D图形API外，画布还支持使用 <abbr title="A 3D graphics API for use on web pages. WebGL programs are written in the JavaScript programming language and display their images in HTML canvas elements. WebGL is based on OpenGL ES, the version of OpenGL for embedded systems, with a few changes to adapt it to the JavaScript language and the Web environment.">WebGL</abbr> 进行3D绘图，这是 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 使用的，它与2D API的差异非常大。</p>
<p><em>Three.js</em> 是一个面向对象的场景图API。（见 <a href="../../c2/s4/#242--场景图">2.4.2小节</a>。）基本过程是使用 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 对象构建场景图，然后渲染它所代表的场景的图像。通过在帧之间修改场景图的属性，可以实现动画。</p>
<p><em>Three.js</em> 库由大量的类组成。其中最基础的三个是 <em>THREE.Scene</em>、<em>THREE.Camera</em> 和 <em>THREE.WebGLRenderer</em>。（实际上有几种渲染器类可用。<em>THREE.WebGLRenderer</em> 是迄今为止最常见的。一个用于 <abbr title="A new JavaScript graphics API, similar to WebGL, but designed to let web programs access modern GPU capabilities such as compute shaders.">WebGPU</abbr> 的渲染器尚在开发中。）一个 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 程序至少需要每种类型一个对象。这些对象通常存储在全局变量中：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">scene</span><span class="p">,</span><span class="w"> </span><span class="nx">renderer</span><span class="p">,</span><span class="w"> </span><span class="nx">camera</span><span class="p">;</span>
</code></pre></div>
<p>注意，我们使用的几乎所有 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 类和常量都是一个名为 THREE 的对象的属性，并且它们的名称以 "THREE." 开头。（名称 "<strong>THREE</strong>" 是在导入 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 特性的导入语句中定义的；你可以使用不同的名称。）我有时会在不使用此前缀的情况下引用类，它通常不在使用 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 文档中，但在实际程序代码中必须始终包括前缀。</p>
<p>一个 <strong>Scene</strong> 对象是一个3D世界中构成所有对象的容器，包括灯光、图形对象，可能还有摄像机。它作为场景图的根节点。一个 <strong>Camera</strong> 是一种特殊类型的对象，代表一个视点，可以从该视点制作3D世界的图像。它代表一个视图变换和投影的组合。一个 <strong>WebGLRenderer</strong> 是一个可以从场景图中创建图像的对象。</p>
<p>场景是三个对象中最简单的。可以使用不带参数的构造函数将场景创建为 THREE.Scene 类型的对象：</p>
<div class="highlight"><pre><span></span><code><span class="nx">scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>
</code></pre></div>
<p><em>scene.add(item)</em> 函数可以用来向 <em>scene</em> 添加摄像机、灯光和图形对象。这可能是你唯一需要调用的场景函数。偶尔也有用的是 <em>scene.remove(item)</em> 函数，它从场景中移除一个项目。</p>
<hr />
<p>有两种摄像机，一种使用正交投影，一种使用透视投影。它们由类 <strong>THREE.OrthographicCamera</strong> 和 <strong>THREE.PerspectiveCamera</strong> 表示，它们是 <strong>THREE.Camera</strong> 的子类。构造函数使用熟悉的参数来指定投影（见 <a href="../../c3/s3/#333-投影变换">3.3.3小节</a>）：</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">OrthographicCamera</span><span class="p">(</span><span class="w"> </span><span class="nx">left</span><span class="p">,</span><span class="w"> </span><span class="nx">right</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="p">,</span><span class="w"> </span><span class="nx">bottom</span><span class="p">,</span><span class="w"> </span><span class="nx">near</span><span class="p">,</span><span class="w"> </span><span class="nx">far</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>或</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="w"> </span><span class="nx">fieldOfViewAngle</span><span class="p">,</span><span class="w"> </span><span class="nx">aspect</span><span class="p">,</span><span class="w"> </span><span class="nx">near</span><span class="p">,</span><span class="w"> </span><span class="nx">far</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>正交摄像机的参数指定视体的 x、y 和 z 限制，在眼睛坐标系中——即在坐标系中，摄像机位于 (0,0,0)，朝向负 z 轴方向，y 轴指向视图的上方。<em>near</em> 和 <em>far</em> 参数以距离摄像机的方式给出 z 限制。对于正交投影，<em>near</em> 可以是负数，将“近”裁剪平面放置在摄像机后面。参数与 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 函数 <em>glOrtho()</em> 的相同，只是反转了指定顶部和底部裁剪平面的两个参数的顺序。</p>
<p>透视摄像机更常见。透视摄像机的参数来自 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 的 <abbr title="The OpenGL Utility library. Defines several functions for use with older versions of OpenGL, including gluPerspective and gluLookAt. Not to be confused with GLUT. GLU is a standard part of OpenGL.">GLU</abbr> 库中的 <em>gluPerspective()</em> 函数。第一个参数确定视体的垂直范围，以度为单位的角度给出。<em>aspect</em> 是水平和垂直范围之间的比率；它通常应该设置为画布的宽度除以其高度。<em>near</em> 和 <em>far</em> 给出视体的 z 限制，作为距离摄像机的距离。对于透视投影，两者都必须是正数，<em>near</em> 小于 <em>far</em>。创建透视摄像机的典型代码将是：</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="w"> </span><span class="mf">45</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>其中 <em>canvas</em> 保存对图像将被渲染的 <code>&lt;canvas&gt;</code> 元素的引用。近和远的值意味着只有位于摄像机前 1 到 100 单位之间的物体被包含在图像中。记住，使用过大的 far 值或过小的 near 值可能会干扰深度测试的准确性。</p>
<p>像其他对象一样，摄像机可以被添加到场景中，但它不必是场景图的一部分才能被使用。如果你想让它成为图中另一个对象的父对象或子对象，你可能会将它添加到场景图。无论如何，你通常希望对摄像机应用建模变换，以设置其在3D空间中的位置和方向。当我更一般地讨论变换时，我将在后面介绍这一点。</p>
<hr />
<p>渲染器是 <strong>THREE.WebGLRenderer</strong> 类的一个实例。它的构造函数有一个参数，这是一个包含影响渲染器设置的 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 对象。你最有可能指定的设置是 canvas（告诉渲染器在哪里绘制）和 antialias（请求渲染器尽可能使用抗锯齿）：</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">({</span>
<span class="w">    </span><span class="nx">canvas</span><span class="o">:</span><span class="w"> </span><span class="nx">theCanvas</span><span class="p">,</span>
<span class="w">    </span><span class="nx">antialias</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">});</span>
</code></pre></div>
<p>在这里，<em>theCanvas</em> 将是渲染器将显示它产生的图像的 <code>&lt;canvas&gt;</code> 元素的引用。（注意，将 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 对象作为参数的技术在许多 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 函数中使用。它允许支持大量选项，而无需要求一个必须按特定顺序指定的长参数列表。相反，你只需要指定你想要提供非默认值的选项，并且可以按任何顺序通过名称指定这些选项。）</p>
<p>你想要使用渲染器做的主要是渲染图像。为此，你还需要一个场景和一台摄像机。要渲染从给定摄像机的视角看给定场景的图像，请调用：</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span><span class="w"> </span><span class="nx">camera</span><span class="p">);</span>
</code></pre></div>
<p>这确实是任何 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 应用中的中心命令。</p>
<p>（我应该指出，我见过的大多数示例没有向渲染器提供 canvas；相反，它们允许渲染器创建它。然后可以从渲染器获取 canvas 并将其添加到页面。此外，canvas 通常填充整个浏览器窗口。示例程序 <a href="../../../en/source/threejs/full-window.html">threejs/full-window.html</a> 展示了如何做到这一点。然而，我的所有其他示例都使用现有的 canvas，渲染器构造函数如上所示。）</p>
</div>
<div class="tabbed-block">
<p><em>Three.js</em> works with the <abbr title="HyperText Markup Language. A language that is used for specifying the content of web pages. An HTML document is made up of text, along with &quot;elements&quot; for adding other content, such as images, and for defining the structure of the document. Because of nesting of elements, the document can be represented by a tree-like data structure.">HTML</abbr> <code>&lt;canvas&gt;</code> element, the same thing that we used for 2D graphics in <a href="../../c2/s6/">Section 2.6</a>. In almost all web browsers, in addition to its 2D Graphics <abbr title="Application Programming Interface. A collection of related classes, functions, constants, etc., for performing some task. An API is an &quot;interface&quot; in the sense that it can be used without understanding how its functionality is actually implemented.">API</abbr>, a canvas also supports drawing in 3D using <abbr title="A 3D graphics API for use on web pages. WebGL programs are written in the JavaScript programming language and display their images in HTML canvas elements. WebGL is based on OpenGL ES, the version of OpenGL for embedded systems, with a few changes to adapt it to the JavaScript language and the Web environment.">WebGL</abbr>, which is used by <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> and which is about as different as it can be from the 2D <abbr title="Application Programming Interface. A collection of related classes, functions, constants, etc., for performing some task. An API is an &quot;interface&quot; in the sense that it can be used without understanding how its functionality is actually implemented.">API</abbr>.</p>
<p><em>Three.js</em> is an object-oriented <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> <abbr title="Application Programming Interface. A collection of related classes, functions, constants, etc., for performing some task. An API is an &quot;interface&quot; in the sense that it can be used without understanding how its functionality is actually implemented.">API</abbr>. (See <a href="../../c2/s4/#242--场景图">Subsection 2.4.2</a>.) The basic procedure is to build a <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> out of <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> objects, and then to render an image of the scene it represents. Animation can be implemented by modifying properties of the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> between frames.</p>
<p>The <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> library is made up of a large number of classes. Three of the most basic are <em>THREE.Scene</em>, <em>THREE.Camera</em>, and <em>THREE.WebGLRenderer</em>. (There are actually several renderer classes available. <em>THREE.WebGLRenderer</em> is by far the most common. A renderer for <abbr title="A new JavaScript graphics API, similar to WebGL, but designed to let web programs access modern GPU capabilities such as compute shaders.">WebGPU</abbr> is available but is still under development.) A <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> program will need at least one object of each type. Those objects are often stored in global variables</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">scene</span><span class="p">,</span><span class="w"> </span><span class="nx">renderer</span><span class="p">,</span><span class="w"> </span><span class="nx">camera</span><span class="p">;</span>
</code></pre></div>
<p>Note that almost all of the <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> classes and constants that we will use are properties of an object named THREE, and their names begin with "THREE.". (The name "<strong>THREE</strong>" is defined in the import statement that imports the <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> features; you can use a different name.) I will sometimes refer to classes without using this prefix, and it is not usually used in the <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> documentation, but the prefix must always be included in actual program code.</p>
<p>A <strong>Scene</strong> object is a holder for all the objects that make up a 3D world, including lights, graphical objects, and possibly cameras. It acts as a root node for the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>. A <strong>Camera</strong> is a special kind of object that represents a viewpoint from which an image of a 3D world can be made. It represents a combination of a <abbr title="Setting the position and orientation of the viewer in a 3D world, which determine what will be visible when the 2D image of a 3D world is rendered.">viewing</abbr> transformation and a <abbr title="A transformation that maps coordinates in 3D to coordinates in 2D. Projection is used to convert a three-dimensional scene into a two-dimensional image.">projection</abbr>. A <strong>WebGLRenderer</strong> is an object that can create an image from a <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>.</p>
<p>The scene is the simplest of the three objects. A scene can be created as an object of type THREE.Scene using a <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> with no parameters:</p>
<div class="highlight"><pre><span></span><code><span class="nx">scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>
</code></pre></div>
<p>The function <em>scene.add(item)</em> can be used to add cameras, lights, and graphical objects to the <em>scene</em>. It is probably the only scene function that you will need to call. The function <em>scene.remove(item)</em>, which removes an item from the scene, is also occasionally useful.</p>
<hr />
<p>There are two kinds of <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>, one using <abbr title="A projection from 3D to 2D that simply discards the z-coordinate. It projects objects along lines that are orthogonal (perpendicular) to the xy-plane. In OpenGL 1.1, the view volume for an orthographic projection is a rectangular solid.">orthographic projection</abbr> and one using <abbr title="A projection from 3D to 2D that projects objects along lines radiating out from a viewpoint. A perspective projection attempts to simulate realistic viewing. A perspective projection preserves perspective; that is, objects that are farther from the viewpoint are smaller in the projection. In OpenGL 1.1, the view volume for a perspective projection is a frustum, or truncated pyramid.">perspective projection</abbr>. They are represented by classes <strong>THREE.OrthographicCamera</strong> and <strong>THREE.PerspectiveCamera</strong>, which are subclasses of <strong>THREE.Camera</strong>. The constructors specify the <abbr title="A transformation that maps coordinates in 3D to coordinates in 2D. Projection is used to convert a three-dimensional scene into a two-dimensional image.">projection</abbr>, using parameters that are familiar from <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> (see <a href="../../c3/s3/#333-投影变换">Subsection 3.3.3</a>):</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">OrthographicCamera</span><span class="p">(</span><span class="w"> </span><span class="nx">left</span><span class="p">,</span><span class="w"> </span><span class="nx">right</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="p">,</span><span class="w"> </span><span class="nx">bottom</span><span class="p">,</span><span class="w"> </span><span class="nx">near</span><span class="p">,</span><span class="w"> </span><span class="nx">far</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="w"> </span><span class="nx">fieldOfViewAngle</span><span class="p">,</span><span class="w"> </span><span class="nx">aspect</span><span class="p">,</span><span class="w"> </span><span class="nx">near</span><span class="p">,</span><span class="w"> </span><span class="nx">far</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>The parameters for the orthographic <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> specify the x, y, and z limits of the <abbr title="In OpenGL 1.1, the region is 3D space that is visible in the rendered image. For orthographic projections, the view volume is a rectangular solid. For perspective projection, the view volume is a frustum (truncated pyramid).">view volume</abbr>, in <abbr title="The coordinate system on 3D space defined by the viewer. In eye coordinates in OpenGL 1.1, the viewer is located at the origin, looking in the direction of the negative z-axis, with the positive y-axis pointing upwards, and the positive x-axis pointing to the right. The modelview transformation maps objects into the eye coordinate system, and the projection transform maps eye coordinates to clip coordinates.">eye coordinates</abbr>—that is, in a <abbr title="A way of assigning numerical coordinates to geometric points. In two dimensions, each point corresponds to a pair of numbers. In three dimensions, each point corresponds to a triple of numbers.">coordinate system</abbr> in which the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> is at (0,0,0) looking in the direction of the negative z-axis, with the y-axis pointing up in the view. The <em>near</em> and <em>far</em> parameters give the z-limits in terms of distance from the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>. For an <abbr title="A projection from 3D to 2D that simply discards the z-coordinate. It projects objects along lines that are orthogonal (perpendicular) to the xy-plane. In OpenGL 1.1, the view volume for an orthographic projection is a rectangular solid.">orthographic projection</abbr>, <em>near</em> can be negative, putting the "near" clipping plane in back of the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>. The parameters are the same as for the <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> function <em>glOrtho()</em>, except for reversing the order of the two parameters that specify the top and bottom clipping planes.</p>
<p>Perspective cameras are more common. The parameters for the perspective <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> come from the function <em>gluPerspective()</em> in <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr>'s <abbr title="The OpenGL Utility library. Defines several functions for use with older versions of OpenGL, including gluPerspective and gluLookAt. Not to be confused with GLUT. GLU is a standard part of OpenGL.">GLU</abbr> library. The first parameter determines the vertical extent of the <abbr title="In OpenGL 1.1, the region is 3D space that is visible in the rendered image. For orthographic projections, the view volume is a rectangular solid. For perspective projection, the view volume is a frustum (truncated pyramid).">view volume</abbr>, given as an angle measured in degrees. The <em>aspect</em> is the ratio between the horizontal and vertical extents; it should usually be set to the width of the canvas divided by its height. And <em>near</em> and <em>far</em> give the z-limits on the <abbr title="In OpenGL 1.1, the region is 3D space that is visible in the rendered image. For orthographic projections, the view volume is a rectangular solid. For perspective projection, the view volume is a frustum (truncated pyramid).">view volume</abbr> as distances from the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>. For a <abbr title="A projection from 3D to 2D that projects objects along lines radiating out from a viewpoint. A perspective projection attempts to simulate realistic viewing. A perspective projection preserves perspective; that is, objects that are farther from the viewpoint are smaller in the projection. In OpenGL 1.1, the view volume for a perspective projection is a frustum, or truncated pyramid.">perspective projection</abbr>, both must be positive, with <em>near</em> less than <em>far</em>. Typical code for creating a perspective <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> would be:</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="w"> </span><span class="mf">45</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>where <em>canvas</em> holds a reference to the <code>&lt;canvas&gt;</code> element where the image will be rendered. The near and far values mean that only things between 1 and 100 units in front of the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> are included in the image. Remember that using an unnecessarily large value for far or an unnecessarily small value for near can interfere with the accuracy of the <abbr title="A solution to the hidden surface problem that involves keeping track of the depth, or distance from the viewer, of the object currently visible at each pixel in the image. When a new object is drawn at a pixel, the depth of the new object is compared to the depth of the current object to decide which one is closer to the viewer. The advantage of the depth test is that objects can be rendered in any order. A disadvantage is that only a limited range of depths can be represented in the image.">depth test</abbr>.</p>
<p>A <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>, like other objects, can be added to a scene, but it does not have to be part of the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> to be used. You might add it to the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> if you want it to be a parent or child of another object in the graph. In any case, you will generally want to apply a <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> to the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> to set its position and orientation in 3D space. I will cover that later when I talk about transformations more generally.</p>
<hr />
<p>A renderer is an instance of the class <strong>THREE.WebGLRenderer</strong>. Its <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> has one parameter, which is a <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> object containing settings that affect the renderer. The settings you are most likely to specify are canvas, which tells the renderer where to draw, and antialias, which asks the renderer to use <abbr title="A technique used to reduce the jagged or &quot;staircase&quot; appearance of diagonal lines, text, and other shapes that are drawn using pixels. When a pixel is only partly covered by a geometric shape, then the color of the pixel is a blend of the color of the shape and the color of the background, with the degree of blending depending on the fraction of the pixel that is covered by the geometric shape.">antialiasing</abbr> if possible:</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">canvas</span><span class="o">:</span><span class="w"> </span><span class="nx">theCanvas</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">antialias</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>Here, <em>theCanvas</em> would be a reference to the <code>&lt;canvas&gt;</code> element where the renderer will display the images that it produces. (Note that the technique of having a <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> object as a parameter is used in many <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> functions. It makes it possible to support a large number of options without requiring a long list of parameters that must all be specified in some particular order. Instead, you only need to specify the options for which you want to provide non-default values, and you can specify those options by name, in any order.)</p>
<p>The main thing that you want to do with a renderer is render an image. For that, you also need a scene and a <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>. To render an image of a given scene from the point of view of a given <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr>, call</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="w"> </span><span class="nx">scene</span><span class="p">,</span><span class="w"> </span><span class="nx">camera</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>This is really the central command in any <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> application.</p>
<p>(I should note that most of the examples that I have seen do not provide a canvas to the renderer; instead, they allow the renderer to create it. The canvas can then be obtained from the renderer and added to the page. Furthermore, the canvas typically fills the entire browser window. The sample program <a href="../../../en/source/threejs/full-window.html">threejs/full-window.html</a> shows how to do that. However, all of my other examples use an existing canvas, with the renderer <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> shown above.)</p>
</div>
</div>
</div>
<h2 id="513-threeobject3d">5.1.3 THREE.Object3D<a class="headerlink" href="#513-threeobject3d" title="Permanent link">&para;</a></h2>
<p><strong>THREE.Object3D</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 场景图由 <strong>THREE.Object3D</strong> 类型的对象组成（包括属于该类的子类的物体）。摄像机、灯光和可见物体都由 <strong>Object3D</strong> 的子类表示。实际上，<strong>THREE.Scene</strong> 本身也是 <strong>Object3D</strong> 的一个子类。</p>
<p>任何 <strong>Object3D</strong> 都包含一个子对象列表，这些子对象也是 <strong>Object3D</strong> 类型。子列表定义了场景图的结构。如果 <em>node</em> 和 object 是 Object3D 类型，那么方法 <em>node.add(object)</em> 将 <em>object</em> 添加到 <em>node</em> 的子列表中。方法 <em>node.remove(object)</em> 可以用来从列表中移除一个对象。</p>
<p><em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 场景图实际上是一棵树。也就是说，图中的每个节点都有一个唯一的父节点，除了根节点，它没有父节点。一个 <strong>Object3D</strong>，obj，有一个属性 <em>obj.parent</em>，指向场景图中 <em>obj</em> 的父节点（如果有的话）。你永远不应该直接设置这个属性。当节点被添加到另一个节点的子列表时，它会自动设置。如果 <em>obj</em> 在被添加为节点的子节点时已经有父节点，那么 <em>obj</em> 首先从当前父节点的子列表中移除，然后被添加到 <em>node</em> 的子列表中。</p>
<p>一个 <strong>Object3D</strong>，obj，的子节点存储在一个名为 <em>obj.children</em> 的属性中，这是一个普通的 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 数组。然而，你应该总是使用 <em>obj.add()</em> 和 <em>obj.remove()</em> 方法来添加和移除 <em>obj</em> 的子节点。</p>
<p>为了便于复制场景图结构的一部分，Object3D 定义了一个 clone() 方法。这个方法复制节点，包括递归复制节点的子节点。这使得在场景图中包含相同结构的多个副本变得容易：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// 向 node 添加子节点。</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">nodeCopy1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// 修改 nodeCopy1，可能应用一个变换。</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">nodeCopy1</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">nodeCopy2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// 修改 nodeCopy2，可能应用一个变换。</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">nodeCopy2</span><span class="p">);</span>
</code></pre></div>
<p>一个 <strong>Object3D</strong>，<em>obj</em>，有一个关联的变换，由属性 <em>obj.scale</em>、<em>obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr></em> 和 <em>obj.position</em> 给出。这些属性表示在渲染对象及其子节点时应用到对象上的建模变换。对象首先按比例缩放，然后旋转，然后根据这些属性的值进行平移。（变换实际上比这更复杂，但我们现在先保持简单，稍后将回到这个话题。）</p>
<p><em>obj.scale</em> 和 <em>obj.position</em> 的值是 <strong>THREE.Vector3</strong> 类型的对象。一个 <strong>Vector3</strong> 表示三维中的向量或点。（还有类似的类 <strong>THREE.Vector2</strong> 和 <strong>THREE.Vector4</strong>，用于2维和4维的向量。）可以从三个数字构造一个 <strong>Vector3</strong> 对象，这些数字给出向量的坐标：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="w"> </span><span class="mf">17</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">3.14159</span><span class="p">,</span><span class="w"> </span><span class="mf">42</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>这个对象有属性 <em>v.x</em>、<em>v.y</em> 和 <em>v.z</em> 表示坐标。这些属性可以单独设置；例如：<em>v.x = 10</em>。它们也可以一次性设置，使用方法 <em>v.set(x,y,z)</em>。<strong>Vector3</strong> 类还有许多实现向量运算的方法，如加法、点积和叉积。</p>
<p>对于 <strong>Object3D</strong>，<abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr> <em>obj.scale.x</em>、<em>obj.scale.y</em> 和 <em>obj.scale.z</em> 给出对象在 x、y 和 z 方向上的缩放量。默认值当然是 1。调用</p>
<div class="highlight"><pre><span></span><code><span class="nx">obj</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
</code></pre></div>
<p>意味着在渲染时对象将受到 2 的均匀缩放因子。设置</p>
<div class="highlight"><pre><span></span><code><span class="nx">obj</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
</code></pre></div>
<p>只会在 y 方向上将其缩小一半（假设 <em>obj.scale.x</em> 和 <em>obj.scale.z</em> 仍然有它们的默认值）。</p>
<p>类似地，<abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr> <em>obj.position.x</em>、<em>obj.position.y</em> 和 <em>obj.position.z</em> 给出在渲染时将应用于对象的 x、y 和 z 方向上的平移量。例如，由于摄像机是 <strong>Object3D</strong>，设置</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span>
</code></pre></div>
<p>意味着摄像机将从原点的默认位置移动到正 z 轴上的 (0,0,20) 点。当摄像机用于渲染场景时，摄像机上的这种建模变换就成为了视图变换。</p>
<p>对象 <em>obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr></em> 有属性 obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.x、obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.y 和 obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.z，代表关于 x、y 和 z 轴的旋转。角度以弧度为单位。对象首先绕 x 轴旋转，然后绕 y 轴旋转，然后绕 z 轴旋转。（可以改变这个顺序。）obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr> 的值不是一个向量。相反，它属于一个类似的类型，<strong>THREE.Euler</strong>，并且旋转角度被称为 <strong><abbr title="在物体自己的坐标系中表示物体的旋转，给出在该坐标系中围绕x、y和z轴的单独旋转。围绕三个坐标轴的旋转的累积效应取决于旋转应用的顺序。">欧拉角</abbr></strong>。</p>
</div>
<div class="tabbed-block">
<p>A <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> is made up of objects of type <strong>THREE.Object3D</strong> (including objects that belong to subclasses of that class). Cameras, lights, and visible objects are all represented by subclasses of <strong>Object3D</strong>. In fact, <strong>THREE.Scene</strong> itself is also a subclass of <strong>Object3D</strong>.</p>
<p>Any <strong>Object3D</strong> contains a list of child objects, which are also of type <strong>Object3D</strong>. The child lists define the structure of the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>. If <em>node</em> and object are of type Object3D, then the method <em>node.add(object)</em> adds <em>object</em> to the list of children of <em>node</em>. The method <em>node.remove(object)</em> can be used to remove an object from the list.</p>
<p>A <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> must, in fact, be a tree. That is, every node in the graph has a unique parent node, except for the root node, which has no parent. An <strong>Object3D</strong>, obj, has a property <em>obj.parent</em> that points to the parent of <em>obj</em> in the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>, if any. You should never set this property directly. It is set automatically when the node is added to the child list of another node. If <em>obj</em> already has a parent when it is added as a child of node, then <em>obj</em> is first removed from the child list of its current parent before it is added to the child list of <em>node</em>.</p>
<p>The children of an <strong>Object3D</strong>, obj, are stored in a property named <em>obj.children</em>, which is an ordinary <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> array. However, you should always add and remove children of <em>obj</em> using the methods <em>obj.add()</em> and <em>obj.remove()</em>.</p>
<p>To make it easy to duplicate parts of the structure of a <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>, Object3D defines a clone() method. This method copies the node, including the recursive copying of the children of that node. This makes it easy to include multiple copies of the same structure in a <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// Add children to node.</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">nodeCopy1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// Modify nodeCopy1, maybe apply a transformation.</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">nodeCopy1</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">nodeCopy2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
<span class="w">    </span><span class="p">.</span>
<span class="w">    </span><span class="p">.</span><span class="w">  </span><span class="c1">// Modify nodeCopy2, maybe apply a transformation.</span>
<span class="w">    </span><span class="p">.</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">nodeCopy2</span><span class="p">);</span>
</code></pre></div>
<p>An <strong>Object3D</strong>, <em>obj</em>, has an associated transformation, which is given by properties <em>obj.scale</em>, <em>obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr></em>, and <em>obj.position</em>. These properties represent a <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> to be applied to the object and its children when the object is rendered. The object is first scaled, then rotated, then translated according to the values of these properties. (Transformations are actually more complicated than this, but we will keep things simple for now and will return to the topic later.)</p>
<p>The values of <em>obj.scale</em> and <em>obj.position</em> are objects of type <strong>THREE.Vector3</strong>. A <strong>Vector3</strong> represents a <abbr title="An element of a vector space. Elements of a vector space can be added and can be multiplied by constants. For computer graphics, a vector is just a list or array containing two, three, or four numbers. Vectors in that sense are often used to represent points in 2D, 3D, or 4D space. Properly, however, a vector represents a quantity that has a length and a direction; a vector used in this way can be visualized as an arrow.">vector</abbr> or point in three dimensions. (There are similar classes <strong>THREE.Vector2</strong> and <strong>THREE.Vector4</strong> for vectors in 2 and 4 dimensions.) A <strong>Vector3</strong> object can be constructed from three numbers that give the coordinates of the <abbr title="An element of a vector space. Elements of a vector space can be added and can be multiplied by constants. For computer graphics, a vector is just a list or array containing two, three, or four numbers. Vectors in that sense are often used to represent points in 2D, 3D, or 4D space. Properly, however, a vector represents a quantity that has a length and a direction; a vector used in this way can be visualized as an arrow.">vector</abbr>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="w"> </span><span class="mf">17</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">3.14159</span><span class="p">,</span><span class="w"> </span><span class="mf">42</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>This object has properties <em>v.x</em>, <em>v.y</em>, and <em>v.z</em> representing the coordinates. The properties can be set individually; for example: <em>v.x = 10</em>. They can also be set all at once, using the method <em>v.set(x,y,z)</em>. The <strong>Vector3</strong> class also has many methods implementing <abbr title="An element of a vector space. Elements of a vector space can be added and can be multiplied by constants. For computer graphics, a vector is just a list or array containing two, three, or four numbers. Vectors in that sense are often used to represent points in 2D, 3D, or 4D space. Properly, however, a vector represents a quantity that has a length and a direction; a vector used in this way can be visualized as an arrow.">vector</abbr> operations such as addition, <abbr title="The dot product of two vectors is the sum of the products of corresponding coordinates. For 3D vectors `v=(x,y,z)` and `w=(a,b,c)`, the dot product of v and w is `x*a+y*b+z*c`. The dot product is equal to the cosine of the angle between the vectors, divided by the product of their lengths.">dot product</abbr>, and <abbr title="A vector product of two 3D vectors. The cross product of v and w is a vector that is perpendicular to both v and w and whose length is equal to the absolute value of the sine of the angle between v and w. If v=(x,y,z) and w=(a,b,c), then their cross product is the vector (yc-zb,za-xc,xb-ya).">cross product</abbr>.</p>
<p>For an <strong>Object3D</strong>, the properties <em>obj.scale.x</em>, <em>obj.scale.y</em>, and <em>obj.scale.z</em> give the amount of <abbr title="A geometric transform that multiplies each coordinate of a point by a number called the scaling factor. Scaling increases or decreases the size of an object, but also moves its points closer to or farther from the origin. Scaling can be uniform—the same in every direction—or non-uniform—with a different scaling factor in each coordinate direction. A negative scaling factor can be used to apply a reflection.">scaling</abbr> of the object in the x, y, and z directions. The default values, of course, are 1. Calling</p>
<div class="highlight"><pre><span></span><code><span class="nx">obj</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
</code></pre></div>
<p>means that the object will be subjected to a uniform <abbr title="A geometric transform that multiplies each coordinate of a point by a number called the scaling factor. Scaling increases or decreases the size of an object, but also moves its points closer to or farther from the origin. Scaling can be uniform—the same in every direction—or non-uniform—with a different scaling factor in each coordinate direction. A negative scaling factor can be used to apply a reflection.">scaling</abbr> factor of 2 when it is rendered. Setting</p>
<div class="highlight"><pre><span></span><code><span class="nx">obj</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
</code></pre></div>
<p>will shrink it to half-size in the y-direction only (assuming that <em>obj.scale.x</em> and <em>obj.scale.z</em> still have their default values).</p>
<p>Similarly, the properties <em>obj.position.x</em>, <em>obj.position.y</em>, and <em>obj.position.z</em> give the <abbr title="A geometric transform that adds a given translation amount to each coordinate of a point. Translation is used to move objects without changing their size or orientation.">translation</abbr> amounts that will be applied to the object in the x, y, and z directions when it is rendered. For example, since a <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> is an <strong>Object3D</strong>, setting</p>
<div class="highlight"><pre><span></span><code><span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span>
</code></pre></div>
<p>means that the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> will be moved from its default position at the origin to the point (0,0,20) on the positive z-axis. This <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> on the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> becomes a <abbr title="Setting the position and orientation of the viewer in a 3D world, which determine what will be visible when the 2D image of a 3D world is rendered.">viewing</abbr> transformation when the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> is used to render a scene.</p>
<p>The object <em>obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr></em> has properties obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.x, obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.y, and obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr>.z that represent rotations about the x-, y-, and z-axes. The angles are measured in radians. The object is rotated first about the x-axis, then about the y-axis, then about the z-axis. (It is possible to change this order.) The value of obj.<abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr> is not a <abbr title="An element of a vector space. Elements of a vector space can be added and can be multiplied by constants. For computer graphics, a vector is just a list or array containing two, three, or four numbers. Vectors in that sense are often used to represent points in 2D, 3D, or 4D space. Properly, however, a vector represents a quantity that has a length and a direction; a vector used in this way can be visualized as an arrow.">vector</abbr>. Instead, it belongs to a similar type, <strong>THREE.Euler</strong>, and the angles of <abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr> are called <strong><abbr title="Express the rotation of an object in its own coordinate system, given as individual rotations about the x, y, and z axes in that coordinate system. The cumulative effect of rotations about the three coordinate axes depends on the order in which the rotations are applied.">Euler angles</abbr></strong>.</p>
</div>
</div>
</div>
<h2 id="514-物体几何形状材料">5.1.4 物体、几何形状、材料<a class="headerlink" href="#514-物体几何形状材料" title="Permanent link">&para;</a></h2>
<p><strong>Object, Geometry, Material</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 中，可见对象由点、线或三角形组成。一个单独的对象对应于 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 基元，如 <em>GL_POINTS</em>、<em>GL_LINES</em> 或 <em>GL_TRIANGLES</em>（见 <a href="../../c3/s1/#311--opengl基元">3.1.1小节</a>）。有五个类来表示这些可能性：<strong>THREE.Points</strong> 用于点，<strong>THREE.Mesh</strong> 用于三角形，以及三个类用于线：<strong>THREE.Line</strong>，使用 <em>GL_LINE_STRIP</em> 基元；<strong>THREE.LineSegments</strong>，使用 <em>GL_LINES</em> 基元；和 <strong>THREE.LineLoop</strong>，使用 <em>GL_LINE_LOOP</em> 基元。</p>
<p>可见对象由一些几何体和决定该几何体外观的材料组成。在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，可见对象的几何体和材料本身由 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 类 <strong>THREE.BufferGeometry</strong> 和 <strong>THREE.Material</strong> 表示。</p>
<p><strong>THREE.BufferGeometry</strong> 类型的对象可以存储顶点坐标及其属性。（实际上，顶点坐标也被视为几何体的“<abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr>”。）这些值必须以适合与 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 函数 <em>glDrawArrays</em> 和 <em>glDrawElements</em>（见 <a href="../../c3/s4/#342-gldrawarrays和gldrawelements">3.4.2小节</a>）一起使用的形式存储。对于 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr>，这意味着它们必须存储在类型化数组中。类型化数组类似于普通的 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 数组，只是它的长度是固定的，只能保存特定类型的数值。例如，<strong>Float32Array</strong> 保存 32 位浮点数，<strong>UInt16Array</strong> 保存无符号 16 位整数。类型化数组可以通过指定数组长度的构造函数来创建。例如，</p>
<div class="highlight"><pre><span></span><code><span class="nx">vertexCoords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">300</span><span class="p">);</span><span class="w">  </span><span class="c1">// 300个数字的空间。</span>
</code></pre></div>
<p>或者，构造函数可以以一个普通 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 数组作为其参数。这会创建一个包含从 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 数组中相同的数字的类型化数组。例如，</p>
<div class="highlight"><pre><span></span><code><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span><span class="mf">1.3</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2.89</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5.5</span><span class="p">]);</span>
</code></pre></div>
<p>在这种情况下，data 的长度是六，它包含来自 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 数组的数字副本。</p>
<p>为 <strong>BufferGeometry</strong> 指定顶点是一个多步骤过程。您需要创建一个包含顶点坐标的类型化数组。然后，您需要将该数组包装在一个 <strong>THREE.BufferAttribute</strong> 类型的对象内。最后，您可以将属性添加到几何体中。这里是一个例子：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">vertexCoords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">]);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">vertexAttrib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">vertexCoords</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">geometry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">geometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexAttrib</span><span class="p">);</span>
</code></pre></div>
<p><strong>BufferGeometry</strong> 构造函数的第二个参数是一个整数，它告诉 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 每个顶点的坐标数量。回想一下，一个顶点可以通过 2、3 或 4 个坐标来指定，您需要指定数组为每个顶点提供了多少个数字。转到 <em>setAttribute()</em> 函数，一个 <strong>BufferGeometry</strong> 可以有属性来指定颜色、法向量和纹理坐标，以及其他自定义属性。 <em>setAttribute()</em> 的第一个参数是属性的名称。这里，“position”是指定顶点坐标或位置的属性名称。</p>
<p>类似地，要为每个顶点指定颜色，您可以将颜色的 RGB 分量放入一个 <strong>Float32Array</strong> 中，并使用它来为名为“color”的 <strong>BufferGeometry</strong> 属性指定值。</p>
<p>对于一个具体的例子，假设我们想使用类型为 <strong>THREE.Points</strong> 的 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 对象来表示类型为 <em>GL_POINTS</em> 的原素。假设我们想要在单位球体内部随机放置 10000 个点，每个点都有自己的随机颜色。以下是创建所需 <strong>BufferGeometry</strong> 的一些代码：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">30000</span><span class="p">);</span><span class="w">  </span><span class="c1">// 每个顶点 3 个数字！</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">colorBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">30000</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">10000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 仅使用单位球体内部的点</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">;</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">i</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">pointsGeom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">pointsGeom</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">pointsBuffer</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">));</span>
<span class="nx">pointsGeom</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">colorBuffer</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">));</span>
</code></pre></div>
<hr />
<p>在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，要使一些几何体成为可见对象，我们还需要一个适当的材料。例如，对于类型为 <strong>THREE.Points</strong> 的对象，我们可以使用 <strong>THREE.PointsMaterial</strong> 类型的材料，它是 <strong>Material</strong> 的一个子类。材料可以指定点的颜色和大小等属性：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="nx">sizeAttenuation</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">});</span>
</code></pre></div>
<p>构造函数的参数是一个 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 对象，其属性用于初始化材料。将 <em>sizeAttenuation</em> 属性设置为 <em>false</em> 时，大小以像素为单位；如果是 <em>true</em>，则 <em>size</em> 表示世界坐标中的大小，并且点会根据与观察者的距离进行缩放。如果省略 <em>color</em>，则使用默认值白色。<em>size</em> 的默认值为 1，<em>sizeAttenuation</em> 的默认值为 <em>true</em>。可以完全省略构造函数的参数，以使用所有默认值。<strong>PointsMaterial</strong> 不受照明影响；它简单地显示由其 <em>color</em> 属性指定的颜色。</p>
<p>也可以在对象创建后为材料的属性分配值。例如，</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">();</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="s2">&quot;yellow&quot;</span><span class="p">);</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">sizeAttenuation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</code></pre></div>
<p>请注意，颜色是作为 <em>THREE.Color</em> 类型的值设置的，这是从字符串 "yellow" 构造的。当在材料构造函数中设置颜色属性时，会自动执行相同的从字符串到颜色的转换。</p>
<p>一旦我们有了几何体和材料，我们就可以使用它们来创建类型为 <strong>THREE.Points</strong> 的可见对象，并将其实加到场景中：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">sphereOfPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Points</span><span class="p">(</span><span class="nx">pointsGeom</span><span class="p">,</span><span class="w"> </span><span class="nx">pointsMat</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">sphereOfPoints</span><span class="p">);</span>
</code></pre></div>
<p>这将显示一团黄色的点。但我们希望每个点都有自己的颜色！回想一下，点的颜色存储在几何体中，而不是材料中。我们必须告诉材料使用几何体中的颜色，而不是材料自己的颜色属性。这可以通过将材料属性 <em>vertexColors</em> 的值设置为 <em>true</em> 来完成。所以，我们可以这样创建材料：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="nx">sizeAttenuation</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">vertexColors</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">});</span>
</code></pre></div>
<p>这里使用白色作为材料颜色，因为顶点颜色实际上是乘以材料颜色的，而不仅仅是替换它。</p>
<p>以下演示显示了一个点云。你可以控制点是全部为黄色还是随机着色。你可以动画化点，并且可以控制点的大小和数量。请注意，点被渲染为正方形。</p>
<p><iframe src="../../../en/demos/c5/point-cloud.html" width="650" height="370"></iframe></p>
<hr />
<p>在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，上述材料的颜色参数是通过字符串 "yellow" 指定的。<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中的颜色可以由 <strong><em>THREE.Color</em>* 类型的值表示。</strong><em>THREE.Color</em><em> 类代表一个 RGB 颜色。一个 </em><strong>Color</strong> 对象 c 有属性 <em>c.r</em>、<em>c.g</em> 和 <em>c.b</em>，分别给出红色、蓝色和绿色颜色分量，作为范围在 0.0 到 1.0 之间的浮点数。请注意，没有 <abbr title="An extra component (that is, one of the numbers that are used to specify a color) in a color model that is not part of the actual color specification. The alpha component is extra information. It is most often used to specify the degree of transparency of a color.">alpha</abbr> 分量；<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 将透明度与颜色分开处理。</p>
<p>有几种方式可以构造一个 <strong>*THREE.Color</strong> 对象。构造函数可以接收三个参数，给出 RGB 分量，作为范围在 0.0 到 1.0 之间的实数。它可以接受一个字符串参数，以 <abbr title="Cascading Style Sheets. A language that is used for specifying the style, or presentation, of the content of web pages. CSS can control things like colors, backgrounds, fonts, shadows, borders, and the size and position of elements of the page.">CSS</abbr> 颜色字符串的形式给出颜色，如 2D 画布图形 <abbr title="Application Programming Interface. A collection of related classes, functions, constants, etc., for performing some task. An API is an &quot;interface&quot; in the sense that it can be used without understanding how its functionality is actually implemented.">API</abbr> 中使用的；示例包括 "white"、"red"、"rgb(255,0,0)" 和 "#FF0000"。或者颜色构造函数可以接收一个整数参数，其中每种颜色分量都以整数中的一个八位字段给出。通常，以这种方式表示颜色的整数会写成以 "0x" 开头的十六进制字面量。示例包括 0xff0000 表示红色，0x00ff00 表示绿色，0x0000ff 表示蓝色，0x007050 表示深蓝绿色。以下是使用颜色构造函数的一些示例：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="s2">&quot;skyblue&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// yellow</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">c3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mh">0x98fb98</span><span class="p">);</span><span class="w">  </span><span class="c1">// pale green</span>
</code></pre></div>
<p>在许多上下文中，如 <strong><em>THREE.Points</em><em> 构造函数，</em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr>* 会接受一个字符串或整数，当需要一个颜色时；字符串或整数将通过 Color 构造函数。作为另一个示例，一个 </strong><em>WebGLRenderer</em>* 对象有一个 "clear color" <abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr>，当渲染器渲染场景时用作背景颜色。这个属性可以使用以下任何命令设置：</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;darkgray&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="mh">0x99BBEE</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<hr />
<p>接下来是线条，类型为 <strong><em>THREE.Line</em></strong> 的对象表示一个线带——在 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 中被称为 <em>GL_LINE_STRIP</em> 类型的原素。要得到相同的连接线段条带，加上一条回到起始顶点的线，我们可以使用类型为 <strong><em>THREE.LineLoop</em></strong> 的对象。例如，对于一个三角形的轮廓，我们可以提供一个包含三个点坐标的 BufferGeometry，并使用一个 <strong><em>LineLoop</em></strong>。</p>
<p>我们还需要一个材料。对于线条，材料可以由类型为 <strong><em>THREE.LineBasicMaterial</em></strong> 的对象表示。像往常一样，构造函数的参数是一个 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 对象，其属性可以包括 <em>color</em> 和 <em>linewidth</em>。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">lineMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w">  </span><span class="mh">0xA000A0</span><span class="p">,</span><span class="w">  </span><span class="c1">// purple; 默认是白色</span>
<span class="w">    </span><span class="nx">linewidth</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="w">       </span><span class="c1">// 2 像素；默认是 1</span>
<span class="p">});</span>
</code></pre></div>
<p>（linewidth 属性可能不被尊重。根据规范，<abbr title="A 3D graphics API for use on web pages. WebGL programs are written in the JavaScript programming language and display their images in HTML canvas elements. WebGL is based on OpenGL ES, the version of OpenGL for embedded systems, with a few changes to adapt it to the JavaScript language and the Web environment.">WebGL</abbr> 实现可以将最大线宽设置为 1。）</p>
<p>像点一样，通过在几何体中添加一个 "color" <abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr>，并将 vertexColors 材料属性的值设置为 true，可以为每个目的指定不同的颜色。以下是一个完整的示例，它制作了一个顶点颜色分别为红色、绿色和蓝色的三角形：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">positionBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">    </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w">   </span><span class="c1">// 第一个顶点的坐标。</span>
<span class="w">    </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w">   </span><span class="c1">// 第二个顶点的坐标。</span>
<span class="w">    </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="mf">2</span><span class="w">    </span><span class="c1">// 第三个顶点的坐标。</span>
<span class="p">]);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">colorBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">    </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="c1">// 第一个顶点的颜色（红色）。</span>
<span class="w">    </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="c1">// 第二个顶点的颜色（绿色）。</span>
<span class="w">    </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="w">   </span><span class="c1">// 第三个顶点的颜色（蓝色）。</span>
<span class="p">]);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lineGeometry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">lineGeometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span>
<span class="w">    </span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">positionBuffer</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span>
<span class="p">);</span>
<span class="nx">lineGeometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span>
<span class="w">    </span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">colorBuffer</span><span class="p">,</span><span class="mf">3</span><span class="p">)</span>
<span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lineMaterial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">linewidth</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span>
<span class="w">    </span><span class="nx">vertexColors</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">});</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">triangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineLoop</span><span class="p">(</span><span class="nx">lineGeometry</span><span class="p">,</span><span class="w"> </span><span class="nx">lineMaterial</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">triangle</span><span class="p">);</span>
</code></pre></div>
<p>这产生了以下图像：</p>
<p><a class="glightbox" href="../../../en/c5/threejs-triangle-vertexcolors.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Threejs Triangle Vertexcolors" src="../../../en/c5/threejs-triangle-vertexcolors.png" /></a></p>
<p>"Basic" 在 <strong><em>LineBasicMaterial</em></strong> 中表示这种材料使用基本颜色，这些颜色不需要照明就能看到，也不会受到照明的影响。这通常是线条想要的。</p>
<hr />
<p>在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，网格对象对应于 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 基元 <em>GL_TRIANGLES</em>。网格的几何体对象必须指定哪些顶点是属于哪些三角形的。我们将在<a href="../s2/">下一节</a>中看到如何做到这一点。然而，<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 提供了一些类来表示常见的网格几何体，例如球体、圆柱体和圆环面。对于这些内置类，您只需要调用构造函数即可创建适当的几何体。例如，类 <strong><em>THREE.CylinderGeometry</em></strong> 表示圆柱体的几何体，其构造函数的形式如下：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="nx">radiusTop</span><span class="p">,</span><span class="w"> </span><span class="nx">radiusBottom</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span>
<span class="w">        </span><span class="nx">radiusSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">openEnded</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>
</code></pre></div>
<p>这个构造函数创建的几何体是对圆柱体的近似表示，其轴线沿着 y 轴。它沿着该轴从 <em>−height/2</em> 延伸到 <em>height/2</em>。其圆形顶部的半径是 <em>radiusTop</em>，底部的半径是 <em>radiusBottom</em>。两个半径不必相同；当它们不同时，您将得到一个截断的圆锥而不是真正的圆柱体。使用 <em>radiusTop</em> 的零值可以制作一个实际的圆锥。参数 <em>radiusSegments</em> 和 <em>heightSegments</em> 分别给出圆柱体圆周和长度上的细分数——在 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 的 <abbr title="OpenGL实用工具包。用于编写OpenGL应用程序的跨平台库。OpenGL本身不包含对窗口或事件的支持。GLUT添加了这样的支持。它还具有用于绘制3D形状（如球体和多面体，更不用说茶壶了）的函数。GLUT用C语言编写，并与OpenGL的C API一起使用。然而，许多GLUT函数也在JOGL中可用，它是OpenGL的Java API。一种较新且稍有改进的工具包版本名为“FreeGLUT”，通常用于取代原始版本。">GLUT</abbr> 库中称为切片和堆叠。参数 <em>openEnded</em> 是一个布尔值，指示是否绘制圆柱体的顶部和底部；使用值 <em>true</em> 可以得到一个开放式的管子。最后两个参数允许您制作部分圆柱体。它们的值以弧度为单位，围绕 y 轴测量。仅渲染从 <em>thetaStart</em> 开始到 <em>thetaStart</em> 加上 <em>thetaLength</em> 结束的圆柱体部分。例如，如果 <em>thetaLength</em> 是 Math.PI，您将得到一个半圆柱体。</p>
<p>构造函数的大量参数提供了很多灵活性。所有参数都是可选的。前三个参数的默认值每个都是一。<em>radiusSegments</em> 的默认值是 8，这为平滑圆柱体提供了一个较差的近似。省略最后三个参数将得到一个两端封闭的完整圆柱体。</p>
<p>其他标准网格几何体类似。这里是一些构造函数，列出了所有参数（但请记住，大多数参数是可选的）：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">depth</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">depthSegments</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PlaneGeometry</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">RingGeometry</span><span class="p">(</span><span class="nx">innerRadius</span><span class="p">,</span><span class="w"> </span><span class="nx">outerRadius</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">phiSegments</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">ConeGeometry</span><span class="p">(</span><span class="nx">radiusBottom</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">radiusSegments</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">openEnded</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">phiStart</span><span class="p">,</span><span class="w"> </span><span class="nx">phiLength</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">tube</span><span class="p">,</span><span class="w"> </span><span class="nx">radialSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">tubularSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">arc</span><span class="p">)</span>
</code></pre></div>
<p>类 <strong><em>BoxGeometry</em></strong> 表示以原点为中心的矩形盒子的几何体。它的构造函数有三个参数，用于给出盒子在每个方向上的大小；默认值为一。最后三个参数给出每个方向上的细分数，默认值为一；大于一的值将导致盒子的面被细分为更小的三角形。</p>
<p>类 <strong><em>PlaneGeometry</em></strong> 表示位于 xy 平面上、以原点为中心的矩形的几何体。它的参数与立方体类似。<strong><em>RingGeometry</em></strong> 表示一个圆环，即从中心去掉一个较小圆盘的圆盘。圆环位于 xy 平面上，其中心位于原点。您应该总是指定圆环的内外半径。</p>
<p><strong><em>ConeGeometry</em></strong> 的构造函数与 <strong><em>CylinderGeometry</em></strong> 的构造函数具有完全相同的形式和效果，只是将 radiusTop 设置为零。也就是说，它构建了一个以 y 轴为中心、以原点为中心的圆锥。</p>
<p>对于 <strong><em>SphereGeometry</em></strong>，所有参数都是可选的。构造函数创建了一个以原点为中心、y 轴为轴的球体。第一个参数，给出球体的半径，默认值为一。接下来两个参数给出切片和堆叠的数量，默认值分别为 32 和 16。最后四个参数允许您制作球体的一部分；默认值给出一个完整的球体。这四个参数是以弧度为单位测量的角度。<em>phiStart</em> 和 <em>phiLength</em> 在赤道周围的角度测量，并给出生成的球壳的经度范围。例如：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>创建了球体“西半球”的几何体。最后两个参数是沿着从球体北极到南极的纬度线测量的角度。例如，要得到球体的“北半球”：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">2</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>对于 <strong><em>TorusGeometry</em></strong>，构造函数创建了一个位于 xy 平面上、以原点为中心、z 轴穿过其孔的圆环面。参数 <em>radius</em> 是圆环中心到圆环管中心的距离，而 <em>tube</em> 是管的半径。接下来的两个参数分别给出每个方向上的细分数。最后一个参数，arc，允许您只制作圆环的一部分。它是一个在 0 到 <em>2*Math.PI</em> 之间的角度，沿着圆环管中心的圆周测量。</p>
<p>还有代表正多面体的几何体类：<strong><em>THREE.TetrahedronGeometry</em></strong>、<strong><em>THREE.OctahedronGeometry</em></strong>、<strong><em>THREE.DodecahedronGeometry</em></strong> 和 <strong><em>THREE.IcosahedronGeometry</em></strong>。（对于立方体，使用 <strong><em>BoxGeometry</em></strong>。）这四个类的构造函数接受两个参数。第一个指定多面体的大小，默认值为 1。大小以包含多面体的球体的半径给出。第二个参数是一个整数，称为 <em>detail</em>。默认值 0 给出实际的正多面体。较大的值通过添加额外的面来增加细节。随着细节的增加，多面体成为对球体的更好近似。这可以通过下面的插图更容易理解：</p>
<p><a class="glightbox" href="../../../en/c5/icosahedron-detail.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Icosahedron Detail" src="../../../en/c5/icosahedron-detail.png" /></a></p>
<p>图像显示了使用细节参数等于 0、1、2 和 3 的二十面体几何体的四个网格对象。</p>
<hr />
<p>要创建一个网格对象，您需要一个材料以及一个几何体。有几种材料适合网格对象，包括 <strong><em>THREE.MeshBasicMaterial</em></strong>、<strong><em>THREE.MeshLambertMaterial</em></strong> 和 <strong><em>THREE.MeshPhongMaterial</em></strong>。（还有更多网格材料，包括两种较新的材料，<strong><em>THREE.MeshStandardMaterial</em></strong> 和 <strong><em>THREE.MeshPhysicalMaterial</em></strong>，它们实现了与<strong><abbr title="PBR，基于物理的渲染。这是一个涵盖各种技术的通用术语，用于渲染材料，使其看起来比OpenGL和类似图形API中传统使用的材质更具物理真实感。这个想法是更直接地实现光和材质的实际物理。PBR已经成为实时图形（如视频游戏）中的常见做法。">基于物理的渲染</abbr></strong>相关的技术，这是一种已成为流行的改进渲染方法。然而，我将不会在这里介绍它们。）</p>
<p><strong><em>MeshBasicMaterial</em></strong> 表示一种不受照明影响的颜色；无论场景中是否有灯光，它看起来都是一样的，并且它没有阴影，给它一个平坦的而不是3D的外观。其他两个类代表需要被照亮才能看到的材料。它们实现了称为<strong><abbr title="使用考虑环境光和漫反射的照明方程在原语上计算像素颜色的技术。在Lambert着色中，照明方程仅在原语的顶点上应用。原语中像素的颜色值是通过插值计算顶点的值来计算的。Lambert着色以约翰·兰伯特命名，他在18世纪发展了其基础理论。">Lambert着色</abbr></strong>和<strong><abbr title="使用考虑环境光、漫反射和镜面反射的照明方程在原语上计算像素颜色的技术。在Phong着色中，照明方程应用于每个像素。法向量仅在原语的顶点处指定。在像素中用于照明方程的法向量是通过插值顶点的法向量获得的。Phong着色以Bui Tuong Phong命名，他在20世纪70年代发展了该理论。">Phong着色</abbr></strong>的照明模型。主要的区别是 <strong><em>MeshPhongMaterial</em></strong> 有一个镜面颜色，但 <strong>*MeshLambertMaterial</strong> 没有。它们都可以有散射和自发光颜色。对于所有三种材料类，构造函数有一个参数，一个 <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> 对象，它指定了材料的属性值。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0xbbbb00</span><span class="p">,</span><span class="w">     </span><span class="c1">// 散射和环境光的反射率</span>
<span class="w">    </span><span class="nx">emissive</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">         </span><span class="c1">// 自发光颜色；这是默认值（黑色）</span>
<span class="w">    </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x303030</span><span class="p">,</span><span class="w">  </span><span class="c1">// 镜面光的反射率</span>
<span class="w">    </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">50</span><span class="w">        </span><span class="c1">// 控制镜面高光的大小</span>
<span class="p">});</span>
</code></pre></div>
<p>这个例子显示了 Phong 材料的四个颜色参数。这些参数与 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 中的五个材质属性具有相同的含义（<a href="../../c4/s1/#411-光与材料">4.1.1小节</a>）。Lambert 材料缺少镜面和光泽度，基本网格材料只有颜色参数。</p>
<p>还有一些其他材料属性，您可能需要在构造函数中设置。除了 flatShading，这些适用于所有三种网格材料：</p>
<ul>
<li>vertexColors — 一个布尔属性，可以设置为 <em>true</em> 以使用几何体中的顶点颜色。默认值为 false。</li>
<li><abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> — 一个布尔值，表示是否应将网格绘制为线框模型，只显示其面的轮廓。默认值为 <em>false</em>。一个 <em>true</em> 值最适合使用 <strong><em>MeshBasicMaterial</em></strong>。</li>
<li>wireframeLinewidth — 用于绘制线框的线条宽度，以像素为单位。默认值为 1。（非默认值可能不被尊重。）</li>
<li>visible — 一个布尔值，控制是否渲染使用它的对象，默认值为 <em>true</em>。</li>
<li>side — 值为 <em>THREE.FrontSide</em>、<em>THREE.BackSide</em> 或 <em>THREE.DoubleSide</em>，默认值为 <em>THREE.FrontSide</em>。这决定了是否根据面可见的一侧来绘制网格面。使用默认值 <em>THREE.FrontSide</em>，只有从前面看时才绘制面。<em>THREE.DoubleSide</em> 无论从前面还是从后面看都会绘制它，而 <em>THREE.BackSide</em> 仅从后面看时绘制。对于封闭对象，如立方体或完整球体，只要观察者在对象外部，默认值就讲得通。对于平面、开放管或部分球体，应该将值设置为 <em>THREE.DoubleSide</em>。否则，应该在视图中的对象部分将不会被绘制。</li>
<li>flatShading — 一个 <em>boolean</em> 值，默认为 <em>false</em>。这对 <strong><em>MeshBasicMaterial</em></strong> 不起作用。对于应该看起来“有面”的物体，具有平坦侧面，重要的是将此属性设置为 <em>true</em>。例如，对于立方体或边数较少的圆柱体，就是这样。</li>
</ul>
<p>作为示例，让我们制作一个有光泽的蓝绿色、开放的、五边的管子，侧面平坦：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0088aa</span><span class="p">,</span>
<span class="w">    </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x003344</span><span class="p">,</span>
<span class="w">    </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">    </span><span class="nx">flatShading</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// 使侧面看起来平坦</span>
<span class="w">    </span><span class="nx">side</span><span class="o">:</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span><span class="w">  </span><span class="c1">// 绘制管子的内部</span>
<span class="p">});</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">geom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="nx">geom</span><span class="p">,</span><span class="w"> </span><span class="nx">mat</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</code></pre></div>
<p>您可以使用以下演示来查看几个 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> 网格对象，使用各种几何体和材料。在对象上拖动鼠标以旋转它。您还可以探索正多面体几何体的详细程度。</p>
<p><iframe src="../../../en/demos/c5/mesh-objects.html" width="610" height="370"></iframe></p>
<p>演示可以显示一个线框版本的物体，叠加在实体版本上。在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，线框和实体版本实际上是使用相同几何体但不同材料的两个对象。以完全相同的深度绘制两个对象可能是深度测试的问题。您可能记得从 <a href="../../c3/s4/#341-索引面集">3.4.1小节</a> <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 使用多边形偏移来解决这个问题。在 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中，您可以将多边形偏移应用于材料。在演示中，这是为同时显示线框材料的实体材料完成的。例如，</p>
<div class="highlight"><pre><span></span><code><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">polygonOffset</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">polygonOffsetUnits</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">polygonOffsetFactor</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">side</span><span class="o">:</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span>
<span class="p">});</span>
</code></pre></div>
<p>这里显示的 <em>polygonOffset</em>、<em>polygonOffsetUnits</em> 和 <em>polygonOffsetFactor</em> 设置将略微增加使用此材料的物体的深度，以便它不与同一物体的线框版本发生干扰。</p>
<p>最后一点：您并不总是需要制作新的材料和几何体来制作新对象。您可以在多个对象中重用相同的材料和几何体。</p>
</div>
<div class="tabbed-block">
<p>A visible object in <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> is made up of either points, lines, or triangles. An individual object corresponds to an <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> primitive such as <em>GL_POINTS</em>, <em>GL_LINES</em>, or <em>GL_TRIANGLES</em> (see <a href="../../c3/s1/#311--opengl基元">Subsection 3.1.1</a>). There are five classes to represent these possibilities: <strong>THREE.Points</strong> for points, <strong>THREE.Mesh</strong> for triangles, and three classes for lines: <strong>THREE.Line</strong>, which uses the <em>GL_LINE_STRIP</em> primitive; <strong>THREE.LineSegments</strong>, which uses the <em>GL_LINES</em> primitive; and <strong>THREE.LineLoop</strong>, which uses the <em>GL_LINE_LOOP</em> primitive.</p>
<p>A visible object is made up of some geometry plus a <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> that determines the appearance of that geometry. In <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>, the geometry and <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> of a visible object are themselves represented by <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> classes <strong>THREE.BufferGeometry</strong> and <strong>THREE.Material</strong>.</p>
<p>An object of type <strong>THREE.BufferGeometry</strong> can store <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> coordinates and their <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attributes</abbr>. (In fact, the <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> coordinates are also considered to be an "<abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr>" of the geometry.) These values must be stored in a form suitable for use with the <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> functions <em>glDrawArrays</em> and <em>glDrawElements</em> (see <a href="../../c3/s4/#342-gldrawarrays和gldrawelements">Subsection 3.4.2</a>). For <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr>, this means that they must be stored in typed arrays. A <abbr title="In JavaScript, an array type that is limited to holding numerical values of a single type. For example, the type Float32Array represents arrays that can hold 32-bit floating point values, and Uint8Array arrays can hold only 8-bit integer values. Such arrays are more efficient than general JavaScript arrays for numerical calculations. The were introduced into JavaScript along with HTML canvas graphics and WebGL.">typed array</abbr> is similar to a normal <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> array, except that its length is fixed and it can only hold numerical values of a certain type. For example, a <strong>Float32Array</strong> holds 32-bit floating point numbers, and a <strong>UInt16Array</strong> holds unsigned 16-bit integers. A <abbr title="In JavaScript, an array type that is limited to holding numerical values of a single type. For example, the type Float32Array represents arrays that can hold 32-bit floating point values, and Uint8Array arrays can hold only 8-bit integer values. Such arrays are more efficient than general JavaScript arrays for numerical calculations. The were introduced into JavaScript along with HTML canvas graphics and WebGL.">typed array</abbr> can be created with a <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> that specifies the length of the array. For example,</p>
<div class="highlight"><pre><span></span><code><span class="nx">vertexCoords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">300</span><span class="p">);</span><span class="w">  </span><span class="c1">// Space for 300 numbers.</span>
</code></pre></div>
<p>Alternatively, the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> can take an ordinary <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> array of numbers as its parameter. This creates a <abbr title="In JavaScript, an array type that is limited to holding numerical values of a single type. For example, the type Float32Array represents arrays that can hold 32-bit floating point values, and Uint8Array arrays can hold only 8-bit integer values. Such arrays are more efficient than general JavaScript arrays for numerical calculations. The were introduced into JavaScript along with HTML canvas graphics and WebGL.">typed array</abbr> that holds the same numbers. For example,</p>
<div class="highlight"><pre><span></span><code><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2.89</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5.5</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>In this case, the length of data is six, and it contains copies of the numbers from the <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> array.</p>
<p>Specifying the vertices for a <strong>BufferGeometry</strong> is a multistep process. You need to create a <abbr title="In JavaScript, an array type that is limited to holding numerical values of a single type. For example, the type Float32Array represents arrays that can hold 32-bit floating point values, and Uint8Array arrays can hold only 8-bit integer values. Such arrays are more efficient than general JavaScript arrays for numerical calculations. The were introduced into JavaScript along with HTML canvas graphics and WebGL.">typed array</abbr> containing the coordinates of the vertices. Then you need to wrap that array inside an object of type <strong>THREE.BufferAttribute</strong>. Finally, you can add the <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr> to the geometry. Here is an example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">vertexCoords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="w"> </span><span class="p">]);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">vertexAttrib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">vertexCoords</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">geometry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">geometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;position&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexAttrib</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>The second parameter to the <strong>BufferGeometry</strong> <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> is an integer that tells <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> the number of coordinates of each <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr>. Recall that a <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> can be specified by 2, 3, or 4 coordinates, and you need to specify how many numbers are provided in the array for each <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr>. Turning to the <em>setAttribute()</em> function, a <strong>BufferGeometry</strong> can have <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attributes</abbr> specifying color, normal vectors, and <abbr title="Variation in some property from point-to-point on an object. The most common type is image texture. When an image texture is applied to a surface, the surface color varies from point to point.">texture</abbr> coordinates, as well as other custom <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attributes</abbr>. The first parameter to <em>setAttribute()</em> is the name of the <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr>. Here, "position" is the name of the <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr> that specifies the coordinates, or position, of the vertices.</p>
<p>Similarly, to specify a color for each <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr>, you can put the RGB components of the colors into a <strong>Float32Array</strong>, and use that to specify a value for the <strong>BufferGeometry</strong> <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr> named "color".</p>
<p>For a specific example, suppose that we want to represent a primitive of type <em>GL_POINTS</em>, using a <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> object of type <strong>THREE.Points</strong>. Let's say we want 10000 points placed at random inside the unit sphere, where each point can have its own random color. Here is some code that creates the necessary <strong>BufferGeometry</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="w"> </span><span class="mf">30000</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// 3 numbers per vertex!</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">colorBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="w"> </span><span class="mf">30000</span><span class="w"> </span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">10000</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="o">*</span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">z</span><span class="o">*</span><span class="nx">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">            </span><span class="c1">// only use points inside the unit sphere</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span>
<span class="w">        </span><span class="nx">pointsBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">;</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">colorBuffer</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">        </span><span class="nx">i</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">pointsGeom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">pointsGeom</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">pointsBuffer</span><span class="p">,</span><span class="mf">3</span><span class="p">));</span>
<span class="nx">pointsGeom</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">colorBuffer</span><span class="p">,</span><span class="mf">3</span><span class="p">));</span>
</code></pre></div>
<hr />
<p>In <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>, to make some geometry into a visible object, we also need an appropriate <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. For example, for an object of type <strong>THREE.Points</strong>, we can use a <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> of type <strong>THREE.PointsMaterial</strong>, which is a subclass of <strong>Material</strong>. The <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> can specify the color and the size of the points, among other properties:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">            </span><span class="nx">sizeAttenuation</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>The parameter to the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> is a <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> object whose properties are used to initialize the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. With the <em>sizeAttenuation</em> property set to <em>false</em>, the size is given in <abbr title="A digital image is made up of rows and columns of small rectangles called pixels. To specify a digital image, a color is assigned to each pixel in the image.">pixels</abbr>; if it is <em>true</em>, then <em>size</em> represents the size in <abbr title="The coordinate system in which a scene is defined. The image that is produced of the scene will show the contents of the world coordinate system that lie within some view volume (for 3D) or view window (for 2D). Objects are defined in their own object coordinate system. Modeling transformations are then applied to place objects into the scene; that is, they transform object coordinates to world coordinates.">world coordinates</abbr> and the point is scaled to reflect distance from the viewer. If the <em>color</em> is omitted, a default value of white is used. The default for <em>size</em> is 1 and for <em>sizeAttenuation</em> is <em>true</em>. The parameter to the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> can be omitted entirely, to use all the defaults. A <strong>PointsMaterial</strong> is not affected by <abbr title="Using light sources in a 3D scene, so that the appearance of objects in the scene can be computed based on the interaction of light with the objects' material properties.">lighting</abbr>; it simply shows the color specified by its <em>color</em> property.</p>
<p>It is also possible to assign values to properties of the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> after the object has been created. For example,</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">();</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="s2">&quot;yellow&quot;</span><span class="p">);</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="nx">pointsMat</span><span class="p">.</span><span class="nx">sizeAttenuation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</code></pre></div>
<p>Note that the color is set as a value of type <em>THREE.Color</em>, which is constructed from a string, "yellow". When the color property is set in the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr>, the same conversion of string to color is done automatically.</p>
<p>Once we have the geometry and the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>, we can use them to create the visible object, of type <strong>THREE.Points</strong>, and add it to a scene:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">sphereOfPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Points</span><span class="p">(</span><span class="w"> </span><span class="nx">pointsGeom</span><span class="p">,</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">sphereOfPoints</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>This will show a cloud of yellow points. But we wanted each point to have its own color! Recall that the colors for the points are stored in the geometry, not in the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. We have to tell the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> to use the colors from the geometry, not the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>'s own color property. This is done by setting the value of the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> property <em>vertexColors</em> to <em>true</em>. So, we could create the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> using</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pointsMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointsMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">            </span><span class="nx">sizeAttenuation</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">            </span><span class="nx">vertexColors</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>White is used here as the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> color because the <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> colors are actually multiplied by the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> color, not simply substituted for it.</p>
<p>The following demo shows a point cloud. You can control whether the points are all yellow or are randomly colored. You can animate the points, and you can control the size and number of points. Note that points are rendered as squares.</p>
<p><iframe src="../../../en/demos/c5/point-cloud.html" width="650" height="370"></iframe></p>
<hr />
<p>The color parameter in the above <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> was specified by the string "yellow". Colors in <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> can be represented by values of type <strong><em>THREE.Color</em></strong>. The class <strong><em>THREE.Color</em></strong> represents an <abbr title="A color specified by three numbers giving the amount of red, green, and blue in the color.">RGB color</abbr>. A <strong><em>Color</em></strong> object c has properties <em>c.r</em>, <em>c.g</em>, and <em>c.b</em> giving the red, blue, and green color components as floating point numbers in the range from 0.0 to 1.0. Note that there is no <abbr title="An extra component (that is, one of the numbers that are used to specify a color) in a color model that is not part of the actual color specification. The alpha component is extra information. It is most often used to specify the degree of transparency of a color.">alpha</abbr> component; <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> handles transparency separately from color.</p>
<p>There are several ways to construct a <strong><em>THREE.Color</em></strong> object. The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> can take three parameters giving the RGB components as real numbers in the range 0.0 to 1.0. It can take a single string parameter giving the color as a <abbr title="Cascading Style Sheets. A language that is used for specifying the style, or presentation, of the content of web pages. CSS can control things like colors, backgrounds, fonts, shadows, borders, and the size and position of elements of the page.">CSS</abbr> color string, like those used in the 2D canvas graphics <abbr title="Application Programming Interface. A collection of related classes, functions, constants, etc., for performing some task. An API is an &quot;interface&quot; in the sense that it can be used without understanding how its functionality is actually implemented.">API</abbr>; examples include "white", "red", "rgb(255,0,0)", and "#FF0000". Or the color <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> can take a single integer parameter in which each <abbr title="One of the numbers used in a color model to specify a color. For example, in the RGB color model, a color is specified by three color components representing the amounts of red, green, and blue in the color.">color component</abbr> is given as an eight-bit field in the integer. Usually, an integer that is used to represent a color in this way is written as a hexadecimal literal, beginning with "0x". Examples include 0xff0000 for red, 0x00ff00 for green, 0x0000ff for blue, and 0x007050 for a dark blue-green. Here are some examples of using color constructors:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="s2">&quot;skyblue&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// yellow</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">c3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mh">0x98fb98</span><span class="p">);</span><span class="w">  </span><span class="c1">// pale green</span>
</code></pre></div>
<p>In many contexts, such as the <strong><em>THREE.Points</em></strong> <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr>, <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> will accept a string or integer where a color is required; the string or integer will be fed through the Color <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr>. As another example, a <strong><em>WebGLRenderer</em></strong> object has a "clear color" property that is used as the background color when the renderer renders a scene. This property could be set using any of the following commands:</p>
<div class="highlight"><pre><span></span><code><span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;darkgray&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="w"> </span><span class="mh">0x99BBEE</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<hr />
<p>Turning next to lines, an object of type <strong><em>THREE.Line</em></strong> represents a line strip—what would be a primitive of the type called <em>GL_LINE_STRIP</em> in <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr>. To get the same strip of connected line segments, plus a line back to the starting <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr>, we can use an object of type <strong><em>THREE.LineLoop</em></strong>. For the outline of a triangle, for example, we could provide a BufferGeometry holding coordinates for three points and use a <strong><em>LineLoop</em></strong>.</p>
<p>We will also need a <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. For lines, the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> can be represented by an object of type <strong><em>THREE.LineBasicMaterial</em></strong>. As usual, the parameter for the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> is a <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> object, whose properties can include <em>color</em> and <em>linewidth</em>. For example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">lineMat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w">  </span><span class="mh">0xA000A0</span><span class="p">,</span><span class="w">  </span><span class="c1">// purple; the default is white</span>
<span class="w">    </span><span class="nx">linewidth</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="w">       </span><span class="c1">// 2 pixels; the default is 1</span>
<span class="p">}</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>(The linewidth property might not be respected. According to the specification, a <abbr title="A 3D graphics API for use on web pages. WebGL programs are written in the JavaScript programming language and display their images in HTML canvas elements. WebGL is based on OpenGL ES, the version of OpenGL for embedded systems, with a few changes to adapt it to the JavaScript language and the Web environment.">WebGL</abbr> implementation can set the maximum line width to 1.)</p>
<p>As with points, it is possible to specify a different color for each purpose by adding a "color" <abbr title="A property, such as color, of a graphical object. An image can be specified by the geometric shapes that it contains, together with their attributes.">attribute</abbr> to the geometry and setting the value of the vertexColors <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> property to true. Here is a complete example that makes a triangle with vertices colored red, green, and blue:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">positionBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">        </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w">   </span><span class="c1">// Coordinates for first vertex.</span>
<span class="w">        </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">,</span><span class="w">   </span><span class="c1">// Coordinates for second vertex.</span>
<span class="w">        </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="mf">2</span><span class="w">    </span><span class="c1">// Coordinates for third vertex.</span>
<span class="w">    </span><span class="p">]);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">colorBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">        </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="c1">// Color for first vertex (red).</span>
<span class="w">        </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">  </span><span class="c1">// Color for second vertex (green).</span>
<span class="w">        </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="w">   </span><span class="c1">// Color for third vertex (blue).</span>
<span class="p">]);</span><span class="w">    </span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lineGeometry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">();</span>
<span class="nx">lineGeometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span>
<span class="w">        </span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">positionBuffer</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="nx">lineGeometry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span>
<span class="w">        </span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferAttribute</span><span class="p">(</span><span class="nx">colorBuffer</span><span class="p">,</span><span class="mf">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lineMaterial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">linewidth</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span>
<span class="w">        </span><span class="nx">vertexColors</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">triangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">LineLoop</span><span class="p">(</span><span class="w"> </span><span class="nx">lineGeometry</span><span class="p">,</span><span class="w"> </span><span class="nx">lineMaterial</span><span class="w"> </span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">triangle</span><span class="p">);</span>
</code></pre></div>
<p>This produces the image:</p>
<p><a class="glightbox" href="../../../en/c5/threejs-triangle-vertexcolors.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="123" src="../../../en/c5/threejs-triangle-vertexcolors.png" /></a></p>
<p>The "Basic" in <strong><em>LineBasicMaterial</em></strong> indicates that this <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> uses basic colors that do not require <abbr title="Using light sources in a 3D scene, so that the appearance of objects in the scene can be computed based on the interaction of light with the objects' material properties.">lighting</abbr> to be visible and are not affected by <abbr title="Using light sources in a 3D scene, so that the appearance of objects in the scene can be computed based on the interaction of light with the objects' material properties.">lighting</abbr>. This is generally what you want for lines.</p>
<hr />
<p>A mesh object in <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> corresponds to the <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> primitive <em>GL_TRIANGLES</em>. The geometry object for a mesh must specify which vertices are part of which triangles. We will see how to do that in the <a href="../s2/">next section</a>. However, <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> comes with classes to represent common mesh geometries, such as a sphere, a cylinder, and a <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr>. For these built-in classes, you just need to call a <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> to create the appropriate geometry. For example, the class <strong><em>THREE.CylinderGeometry</em></strong> represents the geometry for a cylinder, and its <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> takes the form</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="nx">radiusTop</span><span class="p">,</span><span class="w"> </span><span class="nx">radiusBottom</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span>
<span class="w">        </span><span class="nx">radiusSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">openEnded</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>
</code></pre></div>
<p>The geometry created by this <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> represents an approximation for a cylinder that has its axis lying along the y-axis. It extends from <em>−height/2</em> to <em>height/2</em> along that axis. The radius of its circular top is <em>radiusTop</em> and of its bottom is <em>radiusBottom</em>. The two radii don't have to be the same; when the are different, you get a truncated cone rather than a cylinder as such. Using a value of zero for <em>radiusTop</em> makes an actual cone. The parameters <em>radiusSegments</em> and <em>heightSegments</em> give the number of subdivisions around the circumference of the cylinder and along its length respectively—what are called slices and stacks in the <abbr title="OpenGL实用工具包。用于编写OpenGL应用程序的跨平台库。OpenGL本身不包含对窗口或事件的支持。GLUT添加了这样的支持。它还具有用于绘制3D形状（如球体和多面体，更不用说茶壶了）的函数。GLUT用C语言编写，并与OpenGL的C API一起使用。然而，许多GLUT函数也在JOGL中可用，它是OpenGL的Java API。一种较新且稍有改进的工具包版本名为“FreeGLUT”，通常用于取代原始版本。">GLUT</abbr> library for <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr>. The parameter <em>openEnded</em> is a boolean value that indicates whether the top and bottom of the cylinder are to be drawn; use the value <em>true</em> to get an open-ended tube. Finally, the last two parameters allow you to make a partial cylinder. Their values are given as angles, measured in radians, about the y-axis. Only the part of the cylinder beginning at <em>thetaStart</em> and ending at <em>thetaStart</em> plus <em>thetaLength</em> is rendered. For example, if <em>thetaLength</em> is Math.PI, you will get a half-cylinder.</p>
<p>The large number of parameters to the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> gives a lot of flexibility. The parameters are all optional. The default value for each of the first three parameters is one. The default for <em>radiusSegments</em> is 8, which gives a poor approximation for a smooth cylinder. Leaving out the last three parameters will give a complete cylinder, closed at both ends.</p>
<p>Other standard mesh geometries are similar. Here are some constructors, listing all parameters (but keep in mind that most of the parameters are optional):</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">depth</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">depthSegments</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PlaneGeometry</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">RingGeometry</span><span class="p">(</span><span class="nx">innerRadius</span><span class="p">,</span><span class="w"> </span><span class="nx">outerRadius</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">phiSegments</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">ConeGeometry</span><span class="p">(</span><span class="nx">radiusBottom</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">radiusSegments</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="nx">heightSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">openEnded</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">widthSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">heightSegments</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">phiStart</span><span class="p">,</span><span class="w"> </span><span class="nx">phiLength</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaStart</span><span class="p">,</span><span class="w"> </span><span class="nx">thetaLength</span><span class="p">)</span>

<span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">tube</span><span class="p">,</span><span class="w"> </span><span class="nx">radialSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">tubularSegments</span><span class="p">,</span><span class="w"> </span><span class="nx">arc</span><span class="p">)</span>
</code></pre></div>
<p>The class <strong><em>BoxGeometry</em></strong> represents the geometry of a rectangular box centered at the origin. Its <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> has three parameters to give the size of the box in each direction; their default value is one. The last three parameters give the number of subdivisions in each direction, with a default of one; values greater than one will cause the faces of the box to be subdivided into smaller triangles.</p>
<p>The class <strong><em>PlaneGeometry</em></strong> represents the geometry of a rectangle lying in the xy-plane, centered at the origin. Its parameters are similar to those for a cube. A <strong><em>RingGeometry</em></strong> represents an annulus, that is, a disk with a smaller disk removed from its center. The ring lies in the xy-plane, with its center at the origin. You should always specify the inner and outer radii of the ring.</p>
<p>The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> for <strong><em>ConeGeometry</em></strong> has exactly the same form and effect as the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> for <strong><em>CylinderGeometry</em></strong>, with the radiusTop set to zero. That is, it constructs a cone with axis along the y-axis and centered at the origin.</p>
<p>For <strong><em>SphereGeometry</em></strong>, all parameters are optional. The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> creates a sphere centered at the origin, with axis along the y-axis. The first parameter, which gives the radius of the sphere, has a default of one. The next two parameters give the numbers of slices and stacks, with default values 32 and 16. The last four parameters allow you to make a piece of a sphere; the default values give a complete sphere. The four parameters are angles measured in radians. <em>phiStart</em> and <em>phiLength</em> are measured in angles around the equator and give the extent in longitude of the spherical shell that is generated. For example,</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>creates the geometry for the "western hemisphere" of a sphere. The last two parameters are angles measured along a line of latitude from the north pole of the sphere to the south pole. For example, to get the sphere's "northern hemisphere":</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">2</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>For <strong><em>TorusGeometry</em></strong>, the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> creates a <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr> lying in the xy-plane, centered at the origin, with the z-axis passing through its hole. The parameter <em>radius</em> is the distance from the center of the <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr> to the center of the <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr>'s tube, while <em>tube</em> is the radius of the tube. The next two parameters give the number of subdivisions in each direction. The last parameter, arc, allows you to make just part of a <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr>. It is an angle between 0 and <em>2*Math.PI</em>, measured along the circle at the center of the tube.</p>
<p>There are also geometry classes representing the regular polyhedra: <strong><em>THREE.TetrahedronGeometry</em></strong>, <strong><em>THREE.OctahedronGeometry</em></strong>, <strong><em>THREE.DodecahedronGeometry</em></strong>, and <strong><em>THREE.IcosahedronGeometry</em></strong>. (For a cube use a <strong><em>BoxGeometry</em></strong>.) The constructors for these four classes take two parameters. The first specifies the size of the <abbr title="A closed 3D figure whose faces, or sides, are polygons. Usually, it is assumed that the faces of a polyhedron do not intersect, except along their edges.">polyhedron</abbr>, with a default of 1. The size is given as the radius of the sphere that contains the <abbr title="A closed 3D figure whose faces, or sides, are polygons. Usually, it is assumed that the faces of a polyhedron do not intersect, except along their edges.">polyhedron</abbr>. The second parameter is an integer called <em>detail</em>. The default value, 0, gives the actual regular <abbr title="A closed 3D figure whose faces, or sides, are polygons. Usually, it is assumed that the faces of a polyhedron do not intersect, except along their edges.">polyhedron</abbr>. Larger values add detail by adding additional faces. As the detail increases, the <abbr title="A closed 3D figure whose faces, or sides, are polygons. Usually, it is assumed that the faces of a polyhedron do not intersect, except along their edges.">polyhedron</abbr> becomes a better approximation for a sphere. This is easier to understand with an illustration:</p>
<p><a class="glightbox" href="../../../en/c5/icosahedron-detail.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="123" src="../../../en/c5/icosahedron-detail.png" /></a></p>
<p>The image shows four mesh objects that use icosahedral geometries with detail parameter equal to 0, 1, 2, and 3.</p>
<hr />
<p>To create a mesh object, you need a <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> as well as a geometry. There are several kinds of <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> suitable for mesh objects, including <strong><em>THREE.MeshBasicMaterial</em></strong>, <strong><em>THREE.MeshLambertMaterial</em></strong>, and <strong><em>THREE.MeshPhongMaterial</em></strong>. (There are more mesh materials, including two newer ones, <strong><em>THREE.MeshStandardMaterial</em></strong> and <strong><em>THREE.MeshPhysicalMaterial</em></strong>, that implement techniques associated with <strong>physically based <abbr title="The process of producing a 2D image from a 3D scene description.">rendering</abbr></strong>, an approach to improved <abbr title="The process of producing a 2D image from a 3D scene description.">rendering</abbr> that has become popular. However, I will not cover them here.)</p>
<p>A <strong><em>MeshBasicMaterial</em></strong> represents a color that is not affected by <abbr title="Using light sources in a 3D scene, so that the appearance of objects in the scene can be computed based on the interaction of light with the objects' material properties.">lighting</abbr>; it looks the same whether or not there are lights in the scene, and it is not shaded, giving it a flat rather than 3D appearance. The other two classes represent materials that need to be lit to be seen. They implement models of <abbr title="Using light sources in a 3D scene, so that the appearance of objects in the scene can be computed based on the interaction of light with the objects' material properties.">lighting</abbr> known as <strong><abbr title="A technique for computing pixel colors on a primitive using a lighting equation that takes into account ambient and diffuse reflection. In Lambert shading, the lighting equation is applied only at the vertices of the primitive. Color values for pixels in the primitive are calculated by interpolating the values that were computed for the vertices. Lambert shading is named after Johann Lambert, who developed the theory on which it is based in the eighteenth century.">Lambert shading</abbr></strong> and <strong><abbr title="A technique for computing pixel colors on a primitive using a lighting equation that takes into account ambient, diffuse, and specular reflection. In Phong shading, the lighting equation is applied at each pixel. Normal vectors are specified only at the vertices of the primitive. The normal vector that is used in the lighting equation at a pixel is obtained by interpolating the normal vectors for the vertices. Phong shading is named after Bui Tuong Phong, who developed the theory in the 1970s.">Phong shading</abbr></strong>. The major difference is that <strong><em>MeshPhongMaterial</em></strong> has a <abbr title="A material property that represents the proportion of incident light that is reflected specularly by a surface.">specular color</abbr> <em>but </em><em>MeshLambertMateri</em>al** does not. Both can have diffuse and emissive colors. For all three <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> classes, the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> has one parameter, a <abbr title="A programming language for web pages. JavaScript code on a web page is executed by a web browser that displays the page, and it can interact with the contents of the web page and with the user. There are JavaScript APIs for 2D and for 3D graphics">JavaScript</abbr> object that specifies values for properties of the <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. For example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0xbbbb00</span><span class="p">,</span><span class="w">     </span><span class="c1">// reflectivity for diffuse and ambient light</span>
<span class="w">        </span><span class="nx">emissive</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w">         </span><span class="c1">// emission color; this is the default (black)</span>
<span class="w">        </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x303030</span><span class="p">,</span><span class="w">  </span><span class="c1">// reflectivity for specular light</span>
<span class="w">        </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">50</span><span class="w">        </span><span class="c1">// controls size of specular highlights</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>This example shows the four color parameters for a Phong <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. The parameters have the same meaning as the five <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> properties in <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> (<a href="../../c4/s1/#411-光与材料">Subsection 4.1.1</a>). A Lambert <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> lacks specular and <abbr title="A material property that determines the size and sharpness of specular highlights. Also called the &quot;specular exponent&quot; because of the way it is used in lighting calculations. In OpenGL, shininess is a number in the range 0 to 128.">shininess</abbr>, and a basic mesh <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> has only the color parameter.</p>
<p>There are a few other <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> properties that you might need to set in the <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr>. Except for flatShading, these apply to all three kinds of mesh <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>:</p>
<ul>
<li>vertexColors — a boolean property that can be set to <em>true</em> to use <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> colors from the geometry. The default is false.</li>
<li><abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> — a boolean value that indicates whether the mesh should be drawn as a <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> model, showing only the outlines of its faces. The default is <em>false</em>. A <em>true</em> value works best with <strong><em>MeshBasicMaterial</em></strong>.</li>
<li>wireframeLinewidth — the width of the lines used to draw the <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr>, in <abbr title="A digital image is made up of rows and columns of small rectangles called pixels. To specify a digital image, a color is assigned to each pixel in the image.">pixels</abbr>. The default is 1. (Non-default values might not be respected.)</li>
<li>visible — a boolean value that controls whether the object on which it is used is rendered or not, with a default of <em>true</em>.</li>
<li>side — has value <em>THREE.FrontSide</em>, <em>THREE.BackSide</em>, or <em>THREE.DoubleSide</em>, with the default being <em>THREE.FrontSide</em>. This determines whether faces of the mesh are drawn or not, depending on which side of the face is visible. With the default value, <em>THREE.FrontSide</em>, a face is drawn only if it is being viewed from the front. <em>THREE.DoubleSide</em> will draw it whether it is viewed from the front or from the back, and <em>THREE.BackSide</em> only if it is viewed from the back. For closed objects, such as a cube or a complete sphere, the default value makes sense, at least as long as the viewer is outside of the object. For a plane, an open tube, or a partial sphere, the value should be set to <em>THREE.DoubleSide</em>. Otherwise, parts of the object that should be in view won't be drawn.</li>
<li>flatShading — a <em>boolean</em> value, with the default being <em>false</em>. This does not work for <strong><em>MeshBasicMaterial</em></strong>. For an object that is supposed to look "faceted," with flat sides, it is important to set this property to <em>true</em>. That would be the case, for example, for a cube or for a cylinder with a small number of sides.</li>
</ul>
<p>As an example, let's make a shiny, blue-green, open, five-sided tube with flat sides:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">(</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0088aa</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x003344</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">    </span><span class="nx">flatShading</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// for flat-looking sides</span>
<span class="w">    </span><span class="nx">side</span><span class="o">:</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span><span class="w">  </span><span class="c1">// for drawing the inside of the tube</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">geom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">10</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="nx">geom</span><span class="p">,</span><span class="nx">mat</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</code></pre></div>
<p>You can use the following demo to view several <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr> mesh objects, using a variety of geometries and materials. Drag your mouse on the object to rotate it. You can also explore the level of detail for the regular <abbr title="A closed 3D figure whose faces, or sides, are polygons. Usually, it is assumed that the faces of a polyhedron do not intersect, except along their edges.">polyhedron</abbr> geometries.</p>
<p><iframe src="../../../en/demos/c5/mesh-objects.html" width="610" height="370"></iframe></p>
<p>The demo can show a <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> version of an object overlaid on a solid version. In <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>, the <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> and solid versions are actually two objects that use the same geometry but different materials. Drawing two objects at exactly the same depth can be a problem for the <abbr title="A solution to the hidden surface problem that involves keeping track of the depth, or distance from the viewer, of the object currently visible at each pixel in the image. When a new object is drawn at a pixel, the depth of the new object is compared to the depth of the current object to decide which one is closer to the viewer. The advantage of the depth test is that objects can be rendered in any order. A disadvantage is that only a limited range of depths can be represented in the image.">depth test</abbr>. You might remember from <a href="../../c3/s4/#341-索引面集">Subsection 3.4.1</a> that <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> uses <abbr title="A multi-sided shape lying in a plane and specified by a list of points, called its vertices, and made up of the line segments from each point in the list to the next point in the list, plus a line segment from the last point in the list to the first point. All the points are required to lie in the same plane. Sometimes the term &quot;polygon&quot; includes the interior of the shape as well as its boundary.">polygon</abbr> offset to solve the problem. In <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em>, you can apply <abbr title="A multi-sided shape lying in a plane and specified by a list of points, called its vertices, and made up of the line segments from each point in the list to the next point in the list, plus a line segment from the last point in the list to the first point. All the points are required to lie in the same plane. Sometimes the term &quot;polygon&quot; includes the interior of the shape as well as its boundary.">polygon</abbr> offset to a <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr>. In the demos, this is done for the solid materials that are shown at the same time as <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> materials. For example,</p>
<div class="highlight"><pre><span></span><code><span class="nx">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span>
<span class="w">    </span><span class="nx">polygonOffset</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span>
<span class="w">    </span><span class="nx">polygonOffsetUnits</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">polygonOffsetFactor</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">side</span><span class="o">:</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span>
<span class="p">});</span>
</code></pre></div>
<p>The settings shown here for <em>polygonOffset</em>, <em>polygonOffsetUnits</em>, and <em>polygonOffsetFactor</em> will increase the depth of the object that uses this <abbr title="The properties of an object that determine how that object interacts with light in the environment. Material properties in OpenGL include, for example, diffuse color, specular color, and shininess.">material</abbr> slightly so that it doesn't interfere with the <abbr title="A style of drawing a polyhedron or polygonal mesh in which only the edges are drawn, resulting in an image made up of line segments.">wireframe</abbr> version of the same object.</p>
<p>One final note: You don't always need to make new materials and geometries to make new objects. You can reuse the same materials and geometries in multiple objects.</p>
</div>
</div>
</div>
<h2 id="515-灯光">5.1.5 灯光<a class="headerlink" href="#515-灯光" title="Permanent link">&para;</a></h2>
<p><strong>Lights</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>与几何体和材料相比，灯光就容易多了！Three.js 有几个类来表示灯光。灯光类是 <em>THREE.Object3D</em> 的子类。一个灯光对象可以被添加到场景中，然后照亮场景中的对象。我们将看看 <em><abbr title="光线平行的光源，都来自同一方向。可以被认为是一个在无限远距离的光源。也称为“太阳”，因为太阳是定向光源的一个例子。">定向光</abbr></em>、<em>点光</em>、<em><abbr title="存在于环境中但没有特定来源的定向光。这是对已经被反射了很多次以至于无法识别原始来源的光的近似。环境光平等地照亮场景中的所有物体。">环境光</abbr></em> 和 <em><abbr title="发出光锥的光源。聚光灯类似于点光源，因为它在3D空间中有位置，光从该位置辐射出来。然而，光只影响处于聚光灯照明锥内的物体。">聚光灯</abbr></em>。</p>
<p>类 <strong><em>THREE.DirectionalLight</em></strong> 表示从给定方向平行照射的光，就像太阳光一样。定向光的位置属性给出了光线照射的方向。（这是所有场景图对象都有的相同 <em>位置</em> <abbr title="图形对象的属性，例如颜色。图像可以通过其包含的几何形状以及它们的属性来指定。">属性</abbr>，类型为 <strong><em>Vector3</em></strong>，但对于定向光，其含义不同。）请注意，光线从给定位置向原点照射。默认位置是向量 (0,1,0)，它提供了沿 y 轴向下照射的光。这个类的构造函数有两个参数：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="p">)</span>
</code></pre></div>
<p>其中 <em>color</em> 指定光的颜色，可以是 <strong><em>THREE.Color</em></strong> 对象，或十六进制整数，或 <abbr title="Cascading Style Sheets. A language that is used for specifying the style, or presentation, of the content of web pages. CSS can control things like colors, backgrounds, fonts, shadows, borders, and the size and position of elements of the page.">CSS</abbr> 颜色字符串。与 <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr> 中不同，灯光没有单独的散射和镜面颜色。<em>intensity</em> 是一个非负数，控制光的亮度，较大的值使光更亮。强度为零的光根本不发光。参数是可选的。颜色的默认值为白色 (0xffffff)，<em>intensity</em> 的默认值为 1。强度可以大于 1，但通常最好小于 1，以避免场景中的照明过强。</p>
<p>假设我们在正 z 轴上有一个相机，朝向原点，我们希望一个与相机朝向相同方向的光线。我们可以使用位置在正 z 轴上的定向光：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">light</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">();</span><span class="w"> </span><span class="c1">// 默认白色光</span>
<span class="nx">light</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light</span><span class="p">);</span>
</code></pre></div>
<p>类 <strong><em>THREE.PointLight</em></strong> 表示从点向所有方向照射的光。该点的位置由光的 <em>position</em> 属性给出。构造函数有三个可选参数：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="p">,</span><span class="w"> </span><span class="nx">cutoff</span><span class="p">)</span>
</code></pre></div>
<p>前两个参数与定向光相同，默认值也相同。<em>cutoff</em> 是一个非负数。如果值为零（这也是默认值），那么光的照明范围延伸到无限远，并且强度不会随着距离而减少。虽然这在物理上不现实，但通常在实践中效果良好。如果 <em>cutoff</em> 大于零，那么光的强度从光的位置的最大值下降到距离光的 <em>cutoff</em> 距离处的强度为零；光对距离大于 <em>cutoff</em> 的物体没有影响。这种光强度随距离减小被称为光源的 <strong><abbr title="指点光源或聚光灯的照明随着距离光源的距离而减少的方式。从物理上讲，照明应该随着距离的平方而减少，但计算机图形学通常使用线性衰减或根本没有衰减。">衰减</abbr></strong>。</p>
<p>第三种类型的光是 <strong><em>THREE.AmbientLight</em></strong>。这个类的存在是为了向场景添加环境光。环境光只有颜色：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">AmbientLight</span><span class="p">(</span><span class="nx">color</span><span class="p">)</span>
</code></pre></div>
<p>向场景中添加环境光对象会向场景中添加指定颜色的环境光。环境光的颜色分量应该相当小，以避免冲淡物体的颜色。</p>
<p>例如，假设我们在 (10,30,15) 处想要一个随着距离减小的黄光点光，范围到 100 单位的距离。我们还想向场景中添加一些黄色的环境光：</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">light</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="mh">0xffffcc</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span>
<span class="nx">light</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="mf">15</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">AmbientLight</span><span class="p">(</span><span class="mh">0x111100</span><span class="p">));</span>
</code></pre></div>
<hr />
<p>第四种类型的光，<strong><em>THREE.SpotLight</em></strong>，对我们来说是新事物。该类型的对象表示一个 <strong><abbr title="发出光锥的光源。聚光灯类似于点光源，因为它在3D空间中有位置，光从该位置辐射出来。然而，光只影响处于聚光灯照明锥内的物体。">聚光灯</abbr></strong>，它类似于点光，只是它不是向所有方向发光，而是只产生一个光锥。光锥的顶点位于光的位置。默认情况下，光锥的轴线从该位置指向原点（所以除非你改变轴线的方向，否则应该将光的位置从原点移开）。构造函数为点光添加了两个参数：</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SpotLight</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="p">,</span><span class="w"> </span><span class="nx">cutoff</span><span class="p">,</span><span class="w"> </span><span class="nx">coneAngle</span><span class="p">,</span><span class="w"> </span><span class="nx">exponent</span><span class="p">)</span>
</code></pre></div>
<p><em>coneAngle</em> 是一个介于 0 和 <em>Math.PI/2</em> 之间的数字，它决定了光锥的大小。它是光锥轴线与光锥侧面之间的角度。默认值是 <em>Math.PI/3</em>。<em>exponent</em> 是一个非负数，它决定了当你从光锥轴线向侧面移动时，光强度减少的速度。默认值 10 给出了合理的结果。<em>exponent</em> 为零则根本没有衰减，以至于与轴线距离不同的物体被均匀照明。</p>
<p>设置 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 聚光灯方向的技术有点奇怪，但它确实使控制方向变得容易。类型为 <strong><em>SpotLight</em></strong> 的对象 <em>spot</em> 有一个名为 spot.target 的属性。目标是场景图节点。聚光灯的光锥指向从聚光灯位置到目标位置的方向。当聚光灯首次创建时，其目标是一个新的、空的 <em>Object3D</em>，位置在 (0,0,0)。然而，你可以将目标设置为场景图中的任何对象，这将使聚光灯朝向该对象发光。为了让 <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 计算聚光灯方向，目标的位置除了原点外，实际上必须是场景图中的节点。例如，假设我们想要一个位于点 (0,0,5) 并指向点 (2,2,0) 的聚光灯：</p>
<div class="highlight"><pre><span></span><code><span class="nx">spotlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SpotLight</span><span class="p">();</span>
<span class="nx">spotlight</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">);</span>
<span class="nx">spotlight</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">spotlight</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">spotlight</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Compared to geometries and materials, lights are easy! Three.js has several classes to represent lights. Light classes are subclasses of <em>THREE.Object3D</em>. A light object can be added to a scene and will then illuminate objects in the scene. We'll look at <em>directional lights</em>, <em>point lights</em>, <em>ambient lights</em>, and <em>spotlights</em>.</p>
<p>The class <strong><em>THREE.DirectionalLight</em></strong> represents light that shines in parallel rays from a given direction, like the light from the sun. The position property of a <abbr title="A light source whose light rays are parallel, all arriving from the same direction. Can be considered to be a light source at an effectively infinite distance. Also called a &quot;sun,&quot; since the Sun is an example of a directional light source.">directional light</abbr> gives the direction from which the light shines. (This is the same <em>position</em> property, of type <strong><em>Vector3</em></strong>, that all <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> objects have, but the meaning is different for directional lights.) Note that the light shines from the given position towards the origin. The default position is the <abbr title="An element of a vector space. Elements of a vector space can be added and can be multiplied by constants. For computer graphics, a vector is just a list or array containing two, three, or four numbers. Vectors in that sense are often used to represent points in 2D, 3D, or 4D space. Properly, however, a vector represents a quantity that has a length and a direction; a vector used in this way can be visualized as an arrow.">vector</abbr> (0,1,0), which gives a light shining down the y-axis. The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> for this class has two parameters:</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="w"> </span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>where <em>color</em> specifies the color of the light, given as a <strong><em>THREE.Color</em></strong> object, or as a hexadecimal integer, or as a <abbr title="Cascading Style Sheets. A language that is used for specifying the style, or presentation, of the content of web pages. CSS can control things like colors, backgrounds, fonts, shadows, borders, and the size and position of elements of the page.">CSS</abbr> color string. Lights do not have separate diffuse and specular colors, as they do in <abbr title="A family of computer graphics APIs that is implemented in many graphics hardware devices. There are several versions of the API, and there are implementations, or &quot;bindings&quot; for several different programming languages. Versions of OpenGL for embedded systems such as mobile phones are known as OpenGL ES. WebGL is a version for use on Web pages. OpenGL can be used for 2D as well as for 3D graphics, but it is most commonly associated with 3D.">OpenGL</abbr>. The <em>intensity</em> is a non-negative number that controls the brightness of the light, with larger values making the light brighter. A light with intensity zero gives no light at all. The parameters are optional. The default for color is white (0xffffff) and for <em>intensity</em> is 1. The intensity can be greater than 1, but values less than 1 are usually preferable, to avoid having too much illumination in the scene.</p>
<p>Suppose that we have a <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> on the positive z-axis, looking towards the origin, and we would like a light that shines in the same direction that the <abbr title="In 3D computer graphics, an object that combines the projection and viewing transforms into an abstraction that imitates a physical camera or eye.">camera</abbr> is looking. We can use a <abbr title="A light source whose light rays are parallel, all arriving from the same direction. Can be considered to be a light source at an effectively infinite distance. Also called a &quot;sun,&quot; since the Sun is an example of a directional light source.">directional light</abbr> whose position is on the positive z-axis:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">light</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">();</span><span class="w"> </span><span class="c1">// default white light</span>
<span class="nx">light</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light</span><span class="p">);</span>
</code></pre></div>
<p>The class <strong><em>THREE.PointLight</em></strong> represents a light that shines in all directions from a point. The location of the point is given by the light's <em>position</em> property. The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> has three optional parameters:</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="w"> </span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="p">,</span><span class="w"> </span><span class="nx">cutoff</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>The first two parameters are the same as for a <abbr title="A light source whose light rays are parallel, all arriving from the same direction. Can be considered to be a light source at an effectively infinite distance. Also called a &quot;sun,&quot; since the Sun is an example of a directional light source.">directional light</abbr>, with the same defaults. The <em>cutoff</em> is a non-negative number. If the value is zero—which is the default—then the illumination from the light extends to infinity, and intensity does not decrease with distance. While this is not physically realistic, it generally works well in practice. If <em>cutoff</em> is greater than zero, then the intensity falls from a maximum value at the light's position down to an intensity of zero at a distance of <em>cutoff</em> from the light; the light has no effect on objects that are at a distance greater than <em>cutoff</em>. This falloff of light intensity with distance is referred to as <strong><abbr title="Refers to the way that illumination from a point light or spot light decreases with distance from the light. Physically, illumination should decrease with the square of the distance, but computer graphics often uses a linear attenuation with distance, or no attenuation at at all.">attenuation</abbr></strong> of the light source.</p>
<p>A third type of light is <strong><em>THREE.AmbientLight</em></strong>. This class exists to add <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> to a scene. An <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> has only a color:</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">AmbientLight</span><span class="p">(</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>Adding an <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> object to a scene adds <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> of the specified color to the scene. The color components of an <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> should be rather small to avoid washing out colors of objects.</p>
<p>For example, suppose that we would like a yellowish <abbr title="A light source whose light rays emanate from a single point. Also called a &quot;lamp,&quot; since a lamp approximates a point source of light. Also called a positional light.">point light</abbr> at (10,30,15) whose illumination falls off with distance from that point, out to a distance of 100 units. We also want to add a bit of yellow <abbr title="Directionless light that exists in an environment but does not seem to come from a particular source in the environment. An approximation for light that has been reflected so many times that its original source can't be identified. Ambient light illuminates all objects in a scene equally.">ambient light</abbr> to the scene:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">light</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="w"> </span><span class="mh">0xffffcc</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">);</span>
<span class="nx">light</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">AmbientLight</span><span class="p">(</span><span class="mh">0x111100</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<hr />
<p>The fourth type of light, <strong><em>THREE.SpotLight</em></strong>, is something new for us. An object of that type represents a <strong><abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr></strong>, which is similar to a <abbr title="A light source whose light rays emanate from a single point. Also called a &quot;lamp,&quot; since a lamp approximates a point source of light. Also called a positional light.">point light</abbr>, except that instead of shining in all directions, a <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> only produces a cone of light. The <abbr title="One of the points that define a geometric primitive, such as the two endpoints of a line segment or the three vertices of a triangle. (The plural is &quot;vertices.&quot;) A vertex can be specified in a coordinate system by giving its x and y coordinates in 2D graphics, or its x, y, and z coordinates in 3D graphics.">vertex</abbr> of the cone is located at the position of the light. By default, the axis of the cone points from that location towards the origin (so unless you change the direction of the axis, you should move the position of the light away from the origin). The <abbr title="In object-oriented programming, a subroutine that is used to create objects. A constructor for a class creates and initializes objects belonging to that class.">constructor</abbr> adds two parameters to those for a <abbr title="A light source whose light rays emanate from a single point. Also called a &quot;lamp,&quot; since a lamp approximates a point source of light. Also called a positional light.">point light</abbr>:</p>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SpotLight</span><span class="p">(</span><span class="w"> </span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">intensity</span><span class="p">,</span><span class="w"> </span><span class="nx">cutoff</span><span class="p">,</span><span class="w"> </span><span class="nx">coneAngle</span><span class="p">,</span><span class="w"> </span><span class="nx">exponent</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>The <em>coneAngle</em> is a number between 0 and <em>Math.PI/2</em> that determines the size of the cone of light. It is the angle between the axis of the cone and the side of the cone. The default value is <em>Math.PI/3</em>. The <em>exponent</em> is a non-negative number that determines how fast the intensity of the light decreases as you move from the axis of the cone toward the side. The default value, 10, gives a reasonable result. An <em>exponent</em> of zero gives no falloff at all, so that objects at all distances from the axis are evenly illuminated.</p>
<p>The technique for setting the direction of a <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> is a little odd, but it does make it easy to control the direction. An object <em>spot</em> of type <strong><em>SpotLight</em></strong> has a property named spot.target. The target is a <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> node. The cone of light from the <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> is pointed in the direction from <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr>'s position towards the target's position. When a <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> is first created, its target is a new, empty <em>Object3D</em>, with position at (0,0,0). However, you can set the target to be any object in the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>, which will make the <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> shine towards that object. For <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> to calculate the <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> direction, a target whose position is anything other than the origin must actually be a node in the <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr>. For example, suppose we want a <abbr title="A light that emits a cone of illumination. A spotlight is similar to a point light in that it has a position in 3D space, and light radiates from that position. However, the light only affects objects that are in the spotlight's cone of illumination.">spotlight</abbr> located at the point (0,0,5) and pointed towards the point (2,2,0):</p>
<div class="highlight"><pre><span></span><code><span class="nx">spotlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">SpotLight</span><span class="p">();</span>
<span class="nx">spotlight</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">);</span>
<span class="nx">spotlight</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">spotlight</span><span class="p">);</span>
<span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">spotlight</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="516-建模示例">5.1.6 建模示例<a class="headerlink" href="#516-建模示例" title="Permanent link">&para;</a></h2>
<p><strong>A Modeling Example</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在本章的剩余部分，我们将更深入地了解 <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr>，但您已经足够了解如何从基本的几何对象构建 3D 模型。示例程序 <a href="../../../en/source/threejs/diskworld-1.html">threejs/diskworld-1</a> 展示了一个非常简单的模型，一辆汽车在圆柱形基座的边缘行驶。汽车的轮胎是旋转的。磁盘世界在下面的左图中显示。右图显示了汽车的一个轴，每个端点都有一个轮胎。</p>
<p><a class="glightbox" href="../../../en/c5/diskworld-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Diskworld-1" src="../../../en/c5/diskworld-1.png" /></a></p>
<p>我将讨论一些用于构建这些模型的代码。如果您想尝试用自己的模型进行实验，可以使用程序 <a href="../../../en/source/threejs/modeling-starter.html">threejs/modeling-starter.html</a> 作为起点。</p>
<p>从简单的东西开始，我们来看看如何从棕色圆柱体和绿色圆锥体制作一棵树。我使用 <strong>Object3D</strong> 来表示整棵树，这样我可以将其作为一个单元处理。这两个几何对象被添加为 <strong>Object3D</strong> 的子节点。</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">trunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">16</span><span class="p">,</span><span class="mf">1</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x885522</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">);</span>
<span class="nx">trunk</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w">  </span><span class="c1">// 将底座向上移动到原点</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">leaves</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">ConeGeometry</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">16</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00BB00</span><span class="p">,</span>
<span class="w">        </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x002000</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">);</span>
<span class="nx">leaves</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// 将圆锥底部移动到树干顶部</span>

<span class="nx">tree</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">trunk</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">leaves</span><span class="p">);</span>
</code></pre></div>
<p>树干是一个高度等于 1 的圆柱体。它的轴线沿着 y 轴，并且以原点为中心。磁盘世界的平面位于 xz 平面上，所以我想将树干的底部移动到该平面上。这是通过设置 <em>trunk.position</em>.y 的值来完成的，它表示要应用于树干的平移。记住，对象有自己的建模坐标系。指定变换的对象属性，如 <em>trunk.position</em>，在该坐标系中变换对象。在这种情况下，树干是一个更大的复合对象的一部分，代表整棵树。在渲染场景时，树干首先通过它自己的建模变换进行变换。然后，它会被应用于整个树的任何建模变换进一步变换。（这种分层建模首次在 <a href="../../c2/s4/#241--构建复杂对象">2.4.1小节</a> 中介绍。）</p>
<p>一旦我们有了树对象，就可以将其添加到代表磁盘世界的模型中。在程序中，模型是一个名为 <em>diskworldModel</em> 的 <strong>Object3D</strong> 类型的对象。模型将包含几棵树，但树不必单独构建。我可以通过克隆已经创建的树来制作更多的树。例如：</p>
<div class="highlight"><pre><span></span><code><span class="nx">tree</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">);</span>
<span class="nx">diskworldModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">tree</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>

<span class="nx">tree</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">5.2</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">);</span>
<span class="nx">diskworldModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">tree</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>这将两棵树添加到模型中，具有不同的大小和位置。当树被克隆时，克隆得到它自己的建模变换属性 <em>position</em> 和 <em>scale</em> 的副本。更改原始树对象中这些属性的值不会影响克隆。</p>
<p>让我们转向一个更复杂的对象，轴和轮子。我开始创建一个轮子，使用圆环面作为轮胎，并使用三个圆柱体的副本作为辐条。在这种情况下，我不是制作一个新的 <strong><em>Object3D</em></strong> 来容纳轮子的所有组件，而是将圆柱体作为圆环的子节点添加。记住，<em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> 中的任何屏幕图节点都可以有子节点。</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">wheel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="w">  </span><span class="c1">// 轮胎；辐条将作为子节点添加</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span><span class="w"> </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0000A0</span><span class="w"> </span><span class="p">})</span>
<span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">yellow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0xffff00</span><span class="p">,</span>
<span class="w">        </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x101010</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">16</span>
<span class="w">    </span><span class="p">});</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">cylinder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="w">  </span><span class="c1">// 高度为 1，直径为 1 的圆柱体</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">32</span><span class="p">,</span><span class="mf">1</span><span class="p">),</span>
<span class="w">    </span><span class="nx">yellow</span>
<span class="p">);</span>

<span class="nx">cylinder</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.15</span><span class="p">);</span><span class="w"> </span><span class="c1">// 使其变细变长，用于辐条。</span>

<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// 添加圆柱体的副本。</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">3</span><span class="p">;</span><span class="w">  </span><span class="c1">// 旋转它用于第二个辐条。</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 旋转它用于第三个辐条。</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>一旦我有了轮子模型，我可以使用它和一个圆柱体来制作轴。对于轴，我使用一个沿着 z 轴的圆柱体。轮子位于 xy 平面上。它面向正确的方向，但它位于轴的中心。要将其移动到轴末端的正确位置，只需沿 z 轴平移即可。</p>
<div class="highlight"><pre><span></span><code><span class="nx">axleModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span><span class="w"> </span><span class="c1">// 包含两个轮子和一个轴的模型。</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">4.3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span><span class="w">  </span><span class="c1">// 将圆柱体缩放，用作轴。</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">2</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// 将其轴旋转到 z 轴上。</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="w"> </span><span class="p">);</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// 轮子位于轴的两端。</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">wheel</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">;</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">wheel</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>请注意，对于第二个轮子，我添加了原始轮子模型而不是克隆。没有必要制作额外的副本。有了 axleModel，我可以从两个轴的副本和其他一些组件构建汽车。</p>
<p>磁盘世界可以被动画化。要实现动画，需要在渲染动画的每一帧之前修改适当场景图节点的属性。例如，要使汽车上的轮子旋转，每帧都会增加每个轴围绕其 z 轴的旋转：</p>
<div class="highlight"><pre><span></span><code><span class="nx">carAxle1</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
<span class="nx">carAxle2</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
</code></pre></div>
<p>这改变了将应用于轴渲染时的建模变换。在它自己的坐标系中，轴的中心轴线沿着 z 轴。围绕 z 轴的旋转旋转了轴及其附着的轮胎，围绕其轴线。</p>
<p>有关示例程序的详细信息，请参见 <a href="../../../en/source/threejs/diskworld-1.html">源代码</a>。</p>
</div>
<div class="tabbed-block">
<p>In the rest of this chapter, we will go much deeper into <abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr>, but you already know enough to build 3D models from basic geometric objects. An example is in the sample program <a href="../../../en/source/threejs/diskworld-1.html">threejs/diskworld-1</a>.html, which shows a very simple model of a car driving around the edge of a cylindrical base. The car has rotating tires. The diskworld is shown in the picture on the left below. The picture on the right shows one of the axles from the car, with a tire on each end.</p>
<p><a class="glightbox" href="../../../en/c5/diskworld-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="123" src="../../../en/c5/diskworld-1.png" /></a></p>
<p>I will discuss some of the code that is used to build these models. If you want to experiment with your own models, you can use the program <a href="../../../en/source/threejs/modeling-starter.html">threejs/modeling-starter.html</a> as a starting point.</p>
<p>To start with something simple, let's look at how to make a tree from a brown cylinder and a green cone. I use an <strong>Object3D</strong> to represent the tree as a whole, so that I can treat it as a unit. The two geometric objects are added as children of the <strong>Object3D</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">trunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">16</span><span class="p">,</span><span class="mf">1</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x885522</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">);</span>
<span class="nx">trunk</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w">  </span><span class="c1">// move base up to origin</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">leaves</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">ConeGeometry</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">16</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00BB00</span><span class="p">,</span>
<span class="w">        </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x002000</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">);</span>
<span class="nx">leaves</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// move bottom of cone to top of trunk</span>

<span class="nx">tree</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">trunk</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">leaves</span><span class="p">);</span>
</code></pre></div>
<p>The trunk is a cylinder with height equal to 1. Its axis lies along the y-axis, and it is centered at the origin. The plane of the diskworld lies in the xz-plane, so I want to move the bottom of the trunk onto that plane. This is done by setting the value of <em>trunk.position</em>.y, which represents a <abbr title="A geometric transform that adds a given translation amount to each coordinate of a point. Translation is used to move objects without changing their size or orientation.">translation</abbr> to be applied to the trunk. Remember that objects have their own modeling <abbr title="A way of assigning numerical coordinates to geometric points. In two dimensions, each point corresponds to a pair of numbers. In three dimensions, each point corresponds to a triple of numbers.">coordinate system</abbr>. The properties of objects that specify transformations, such as <em>trunk.position</em>, transform the object in that <abbr title="A way of assigning numerical coordinates to geometric points. In two dimensions, each point corresponds to a pair of numbers. In three dimensions, each point corresponds to a triple of numbers.">coordinate system</abbr>. In this case, the trunk is part of a larger, compound object that represents the whole tree. When the scene is rendered, the trunk is first transformed by its own <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr>. It is then further transformed by any <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> that is applied to the tree as a whole. (This type of <abbr title="Creating complex geometric models in a hierarchical fashion, starting with geometric primitives, combining them into components that can then be further combined into more complex components, and so on.">hierarchical modeling</abbr> was first covered in <a href="../../c2/s4/#241--构建复杂对象">Subsection 2.4.1</a>.)</p>
<p>Once we have a tree object, it can be added to the model that represents the diskworld. In the program, the model is an object of type <strong>Object3D</strong> named <em>diskworldModel</em>. The model will contain several trees, but the trees don't have to be constructed individually. I can make additional trees by cloning the one that I have already created. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nx">tree</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">);</span>
<span class="nx">diskworldModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">tree</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>

<span class="nx">tree</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">5.2</span><span class="p">);</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">);</span>
<span class="nx">diskworldModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">tree</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>This adds two trees to the model, with different sizes and positions. When the tree is cloned, the clone gets its own copies of the <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> properties, <em>position</em> and <em>scale</em>. Changing the values of those properties in the original tree object does not affect the clone.</p>
<p>Lets turn to a more complicated object, the axle and wheels. I start by creating a wheel, using a <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr> for the tire and using three copies of a cylinder for the spokes. In this case, instead of making a new <strong><em>Object3D</em></strong> to hold all the components of the wheel, I add the cylinders as children of the <abbr title="A 3D geometric object having the shape of a doughnut (or bagel).">torus</abbr>. Remember that any screen graph node in <em><abbr title="一个用于3D图形的JavaScript库。该库实现了面向对象的场景图API。虽然它主要用于WebGL，但three.js也可以使用2D画布图形API渲染3D场景。">three.js</abbr></em> can have child nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">wheel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="w">  </span><span class="c1">// the tire; spokes will be added as children</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span><span class="p">),</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span><span class="w"> </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0000A0</span><span class="w"> </span><span class="p">})</span>
<span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">yellow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
<span class="w">        </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="mh">0xffff00</span><span class="p">,</span>
<span class="w">        </span><span class="nx">specular</span><span class="o">:</span><span class="w"> </span><span class="mh">0x101010</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shininess</span><span class="o">:</span><span class="w"> </span><span class="mf">16</span>
<span class="w">    </span><span class="p">});</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">cylinder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="w">  </span><span class="c1">// a cylinder with height 1 and diameter 1</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">CylinderGeometry</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">32</span><span class="p">,</span><span class="mf">1</span><span class="p">),</span>
<span class="w">    </span><span class="nx">yellow</span>
<span class="p">);</span>

<span class="nx">cylinder</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.15</span><span class="p">);</span><span class="w"> </span><span class="c1">// Make it thin and tall for use as a spoke.</span>

<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// Add a copy of the cylinder.</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">3</span><span class="p">;</span><span class="w">  </span><span class="c1">// Rotate it for the second spoke.</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// Rotate it for the third spoke.</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>Once I have the wheel model, I can use it along with one more cylinder to make the axle. For the axle, I use a cylinder lying along the z-axis. The wheel lies in the xy-plane. It is facing in the correct direction, but it lies in the center of the axle. To get it into its correct position at the end of the axle, it just has to be translated along the z-axis.</p>
<div class="highlight"><pre><span></span><code><span class="nx">axleModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span><span class="w"> </span><span class="c1">// A model containing two wheels and an axle.</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">4.3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span><span class="w">  </span><span class="c1">// Scale the cylinder for use as an axle.</span>
<span class="nx">cylinder</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">2</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// Rotate its axis onto the z-axis.</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">cylinder</span><span class="w"> </span><span class="p">);</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// Wheels are positioned at the two ends of the axle.</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">wheel</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="nx">wheel</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">;</span>
<span class="nx">axleModel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="w"> </span><span class="nx">wheel</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<p>Note that for the second wheel, I add the original wheel model rather than a clone. There is no need to make an extra copy. With the axleModel in hand, I can build the car from two copies of the axle plus some other components.</p>
<p>The diskworld can be animated. To implement the <abbr title="A sequence of images that, when displayed quickly one after the other, will produce the impression of continuous motion or change. The term animation also refers to the process of creating such image sequences.">animation</abbr>, properties of the appropriate <abbr title="A data structure that represents the objects in a scene, together with attributes of the objects and the modeling transformations that are applied to the objects. An image of the scene is created by traversing the scene graph data structure. A scene graph might exist only conceptually, or it might be an actual data structure in a program.">scene graph</abbr> nodes are modified before each frame of the <abbr title="A sequence of images that, when displayed quickly one after the other, will produce the impression of continuous motion or change. The term animation also refers to the process of creating such image sequences.">animation</abbr> is rendered. For example, to make the wheels on the car rotate, the <abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr> of each axle about its z-axis is increased in each frame:</p>
<div class="highlight"><pre><span></span><code><span class="nx">carAxle1</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
<span class="nx">carAxle2</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
</code></pre></div>
<p>This changes the <abbr title="A transformation that is applied to an object to map that object into the world coordinate system or into the object coordinate system for a more complex, hierarchical object.">modeling transformation</abbr> that will be applied to the axles when they are rendered. In its own <abbr title="A way of assigning numerical coordinates to geometric points. In two dimensions, each point corresponds to a pair of numbers. In three dimensions, each point corresponds to a triple of numbers.">coordinate system</abbr>, the central axis of an axle lies along the z-axis. The <abbr title="A geometric transform that rotates each point by a specified angle about some point (in 2D) or axis (in 3D).">rotation</abbr> about the z-axis rotates the axle, with its attached tires, about its axis.</p>
<p>For the full details of the sample program, see the <a href="../../../en/source/threejs/diskworld-1.html">source code</a>.</p>
</div>
</div>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年6月10日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年5月26日</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tabs.link", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "toc.follow", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>